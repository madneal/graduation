\def\ChineseScale{1200}
\input tdw
\documentclass [a4paper,12pt,oneside] {article}
\usepackage{CJK,CJKnumb}
\usepackage{bbm}
\usepackage{tipa}
\usepackage{stmaryrd}
\usepackage{latexsym,bm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[dvips]{graphics}
\usepackage{mathrsfs, tikz, epstopdf}
\usepackage{CJK,CJKnumb}
\usepackage{color}
\usepackage{indentfirst}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{amsthm}
\usepackage{cases}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{float}
\usepackage{subfigure}
\usepackage{multirow}
\usepackage{graphicx,amssymb,lineno,epsfig,subfigure}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{caption}
\usepackage[T1]{fontenc}
\usepackage{float}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{xspace}
\usepackage{setspace}
\usepackage{subeqnarray}
\usepackage{mathrsfs}
\usepackage{extarrows}
\usepackage{algorithm}
\usepackage{dsfont}
\usepackage{bm}
%\usepackage{algorithm2e}
%\usepackage{hyperref}

\newcommand{\song}{\CJKfamily{song}}
\newcommand{\fs}{\CJKfamily{fs}}
\newcommand{\kai}{\CJKfamily{kai}}
\newcommand{\hei}{\CJKfamily{hei}}
\newcommand{\li}{\CJKfamily{li}}
\newcommand{\chuhao}{\fontsize{42pt}{\baselineskip}\selectfont}
\newcommand{\xiaochuhao}{\fontsize{36pt}{\baselineskip}\selectfont}
\newcommand{\yihao}{\fontsize{28pt}{\baselineskip}\selectfont}
\newcommand{\erhao}{\fontsize{21pt}{\baselineskip}\selectfont}
\newcommand{\xiaoerhao}{\fontsize{18pt}{\baselineskip}\selectfont}
\newcommand{\sanhao}{\fontsize{15.75pt}{\baselineskip}\selectfont}
\newcommand{\sihao}{\fontsize{14pt}{\baselineskip}\selectfont}
\newcommand{\xiaosihao}{\fontsize{12pt}{14pt}\selectfont}
\newcommand{\wuhao}{\fontsize{10.5pt}{12.6pt}\selectfont}

\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\ud}[1]{\underset{\raisebox{4pt}{\line(20,0){18}}}{\dim}_{#1}}
\newcommand{\od}[1]{\overset{\line(-1,0){18}}{\dim}_{#1}}
\newcommand{\olim}[1]{\overset{\line(-1,0){18}}{\lim\limits}_{#1}}
\newcommand{\ulim}[1]{\underset{\raisebox{4pt}{\line(20,0){18}}}{\lim\limits}_{#1}}
\newcommand{\h}[2]{\mathcal {H}_{#1}^{#2}}
\newcommand{\p}[2]{\mathcal {P}_{#1}^{#2}}
\newcommand{\de}{\delta}
\newcommand{\ep}{\epsilon}
\newcommand{\f}{\infty}
\newcommand{\T}{\mathbb{T}}
\newcommand{\e}{\mathrm{e}}
\newcommand{\hot}{\mathrm{h.o.t.}}
\newcommand{\q}{\mathbf{q}}
\newcommand{\bi}{\mathbf{i}}
\newcommand{\om}{\omega}
\newcommand{\Om}{\Omega}
\newcommand{\bs}{\mathscr{S}}
\newcommand{\ra}{\rightarrow}
\newcommand{\ta}{\theta}
\newcommand{\Gq}{\Gamma(\Om,\q_{d-1})}
\newcommand{\Gql}{\Gamma(\Om,\q_{l})}
\newcommand{\Oq}{\Om(\q_{d-1})}
\newcommand{\Oql}{\Om(\q_{l})}
\newcommand{\bp}{\mathbbm{p}}
\newcommand{\ba}{\mathscr{A}}
\newcommand{\bg}{\bigwedge}
\newcommand{\bt}{\mathcal {T}}
\newcommand{\tu}{\tilde \mu}
\newcommand{\ga}{\Gamma}
\newcommand{\si}{\sigma}
\newcommand{\Ha}[2]{\mathcal {H}_{#1}^{#2}}
\newcommand{\Pa}[2]{\mathcal {P}_{#1}^{#2}}
\newcommand{\A}{\alpha}
\newcommand{\tw}{\tilde t}
\newcommand{\G}{\Gamma}
\newcommand{\La}{\Lambda}
\newcommand{\la}{\lambda}
\newcommand{\tm}{\tilde\mu}
%%%%%%===== 页面设置 =====
\setlength{\textwidth}{16.5cm}  % 正文宽度
\setlength{\textheight}{24cm}   % 正文高度
\setlength{\hoffset}{-1.5cm}       % 左边距 = \hoffset + 1 英寸
\setlength{\voffset}{-2cm}       % 顶端距离 = \voffset + 1 英寸
\setlength{\parskip}{3pt plus1pt minus1pt}  % 段落之间的竖直距离
\renewcommand{\baselinestretch}{1.5}    % 定义行距

%%%%%%===== 自定义命令 =====
\numberwithin{equation}{section}
\newcommand{\C}{\mathbb{C}}


\begin{document}
\begin{CJK*}{GBK}{song}
\CJKindent\CJKtilde

%%%%%%===== 标题名称中文化 =====
\renewcommand\abstractname{\hei~摘\quad 要}
\renewcommand\refname{\hei~参考文献}
\renewcommand\figurename{\hei~图}
\renewcommand\tablename{\hei~表}
\newtheorem{dingyi}{\hei~定义~}[section]
\newtheorem{dingli}{\hei~定理~}[section]
\newtheorem{yinli}{\hei~引理~}[section]
\newtheorem{tuilun}[dingli]{\hei~推论~}
\newtheorem{mingti}[dingli]{\hei~命题~}
\newtheorem{zhu}{\hei 注~}[section]
%\renewcommand{\listalgorithmcfname}{List of Algorithms}
%\renewcommand{\algorithmcfname}{Algorithm}
%\renewcommand\algorithmcfname{算法}

%\thispagestyle{empty}
%2014~届硕士研究生学位论文\hfill 学校代码~:~10269\hspace*{4mm}\\
%\mbox{}\hfill 学~号:~51110601041 \vfill
%
%%\vfill
%%\begin{center}
%%\scalebox{0.16}{\includegraphics{ecnu.eps}}
%%\end{center}
%% \vfill
%\hspace{-0.9cm}\includegraphics{ecnu_ch_vec.pdf}
% \begin{center}
%  {\huge\CJKfamily{li}{一类具有正向轨道翻转和弱倾斜翻转的异维环分支问题}}\par
%\vfill
%   \begin{tabular}{ll}
%      {\large院\hfill系：}&{\large 理\hfill 工\hfill 学\hfill 院\hfill 数\hfill 学\hfill 系}\\
%      \cline{2-2}\\
%      {\large专~~~业~~~名~~称：}&{\large 应\hfill 用\hfill 数\hfill 学}\\
%      \cline{2-2}\\
%      {\large研~~~究~~~方~~向：}&{\large 微\hfill 分\hfill 方\hfill 程\hfill 分\hfill 支\hfill 理\hfill 论}\\
%      \cline{2-2}\\
%      {\large导~~~师~~~姓~~名：}&{\large 刘\quad\hfill兴\quad\hfill 波\quad\hfill 副\hfill 教\hfill 授}
%      \\
%      \cline{2-2}\\
%      {\large硕~士~研~究~生：}&{\large\quad\quad 丁\quad\quad 玲}
%      \\
%      \cline{2-2}
%    \end{tabular}
%   \vfill
%   {\large 二一四年, 四月$\cdot$ 上海}
% \end{center}

%======================================================================== 封皮=================================%
%=============================================================================================================%
\begin{titlepage}
\makebox[0pt][r]{2015}~届研究生硕士学位论文
\\分类号:~~\underline{~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~}\hspace{149pt}
学校代码:~~\underline{10269}
\\密~~~~级:~~\underline{~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~}\hspace{149pt}
学~~~~~~~~号:~~\underline{51120601152}


\vspace{1.3cm}

\begin{center}
 \includegraphics[width=0.15\textwidth]{ecnu.png}\includegraphics[width=0.75\textwidth]{ECNU_Name_black.png}
\end{center}
%\centerline{\chuhao{\li 华~~东~~师~~范~~ 大~~ 学}}
\centerline{\LARGE\textbf{ East~~China~~Normal~~University}}
\vspace{0.1cm}
\centerline{\LARGE{\hei 硕士学位论文}}
\vspace{0.1cm}
\centerline{\LARGE\textbf{ MASTER'S~~~~DISSERTATION}}
\vspace{1cm}

\centerline{\LARGE{\hei  论文题目:~~\underline{一种基于椒盐噪声的}}}

\vspace{0.15cm}
\centerline{\LARGE{\hei  ~~~~~~~~~~~~~~~~~~~~~\underline{自适应加权均值滤波算法 } }}


\vspace{0.8cm}

\begin{center}
\begin{tabular}{cc}
  {\large\hei院\hfill\hei系：}&{\large\hei 理\hfill\hei工\hfill\hei 学\hfill\hei 院\hfill\hei 数\hfill\hei 学
  \hfill \hei系}\\
      \cline{2-2}\\
      {\large\hei专\hfill\hei业：}&{\large\hei 基\hfill\hei 础\hfill\hei 数\hfill\hei 学}\\
      \cline{2-2}\\
      {\large\hei研~~~\hei究~~~\hei 方~~\hei 向：}&{\large\hei 几\hfill\hei 何\hfill\hei 分\hfill\hei 析\hfill\hei 与\hfill\hei 数\hfill\hei 字\hfill\hei 图\hfill\hei像\hfill\hei 处\hfill\hei 理}\\
      \cline{2-2}\\
      {\large\hei指~~~\hei导~~~\hei 教~~\hei 师：}&{\large\hei 黎\quad\hfill\hei 芳\quad \hfill\hei 副\hfill \hei 教\hfill 授}
      \\
      \cline{2-2}\\
      {\large\hei学~\hei位~\hei申~\hei请~\hei 人：}&{\large\hei 张\quad\quad\hei 培\quad\quad\hei 轩}
      \\
      \cline{2-2}
\end{tabular}
\end{center}
\vfill \centerline{\large 2015~年~\textcolor{red}{3~月~31~ 日}}
\end{titlepage}



%---------------------------英文首页-------------------------------------------------------------------------------------
%\newpage
%\thispagestyle{empty}
% Dissertation for\hfill College Code: 10269
%
% Master degree, 2014\hfill Register Number: 51110601041
%  \vfill
%
%\begin{center}
%\Huge\bf\Huge{East China Normal University} \vspace{\fill}
%\end{center}
%
%  \begin{center}
%  {\Huge\mdseries{Bifurcations of heterodimensional cycles with one positive orbit flip and one weak inclination flip}}\par
%  \vfill
%   \begin{tabular}{ll}
%      {\large  Department：}&{\large Mathematics}\\
%      \cline{2-2}\\
%      {\large  Major：}&{\large Applied  Mathematics}\\
%      \cline{2-2}\\
%      {\large  Subject：}&{\large Bifurcations of Differential  Equations}\\
%      \cline{2-2}\\
%      {\large  Supervisor：}&{\large A. Prof. Xingbo Liu}\\
%      \cline{2-2}\\
%      {\large  Name：}&{\large Ling Ding}\\
%      \cline{2-2}
%    \end{tabular}
%   \vfill
%   {\large Apr，2014 $\cdot$ Shanghai}
%  \end{center}

\newpage
\thispagestyle{empty}
 Dissertation for\hfill Student ID: 51120601152

 Master degree, 2015\hfill University Code: 10269
  \vfill

\begin{center}
\Huge\bf\Huge{East China Normal University} \vspace{\fill}
\end{center}

  \centerline{\sanhao\textbf{ Title:~~\underline{A new adaptive weighted mean filter} }}
\vspace{0.15cm}
\centerline{\sanhao\textbf{ ~~~~~~~~~~\underline{for salt and pepper noise } }}


  \begin{center}
%  {\Huge\mdseries{Bifurcations of heterodimensional cycles with one positive orbit flip and one weak inclination flip}}\par
  \vfill
   \begin{tabular}{ll}
      {\large  Department：}&{\large Mathematics}\\
      \cline{2-2}\\
      {\large  Major：}&{\large Fundamental Mathematics}\\
      \cline{2-2}\\
      {\large  Research direction：}&{\large
      Geometrical Analysis and Digital Image Processing}\\
      \cline{2-2}\\
      {\large  Supervisor：}&{\large A. Prof. Fang Li}\\
      \cline{2-2}\\
      {\large  Candidate：}&{\large Peixuan Zhang}\\
      \cline{2-2}
    \end{tabular}
   \vfill
   {\large \textcolor{red}{May，2015 $\cdot$ Shanghai}}
  \end{center}
\vfill
%%-------------------------独创性声明-------------------------------------------------------------------------------------
\newpage
\thispagestyle{empty}
\centerline{\LARGE\hei 华东师范大学学位论文原创性声明}

\vspace{1cm}
郑重声明:~本人呈交的学位论文《一种基于椒盐噪声的自适应加权均值滤波算法》, 是在华东师范大学攻读硕士~/~ 博士~(~ 请勾选~)~ 学位期间,
在导师的指导下进行的研究工作及取得的研究成果.~除文中已经注明引用的内容外,~ 本论文不包含其他个人已经发表或撰写过的研究成果.~
对本文的研究做出重要贡献的个人和集体,~均已在文中作了明确说明并表示谢意.~
\par
\vspace{0.4cm}  \bf {作者签名: \rule[-4pt]{2cm}{1pt}\hspace{80pt}
日期: \qquad 年\qquad 月\qquad 日}\par \vspace{1cm} \normalfont

\vspace{1cm}
\centerline{\LARGE\hei 华东师范大学学位论文著作权使用声明}

\vspace{0.5cm}
《一种基于椒盐噪声的自适应加权均值滤波算法》系本人在华东师范大学攻读学位期间在导师指导下完成的硕士/博士（请勾选）学位论文,~ 本论文的著作权归本人所有.~本人同意华东师范大学根据相关规定保留和使用此学位论文,~ 并向主管部门和学校指定的相关机构送交学位论文的印刷版和电子版;~ 允许学位论文进入华东师范大学图书馆及数据库被查阅、借阅;~ 同意学校将学位论文加入全国博士、硕士学位论文共建单位数据库进行检索,~ 将学位论文的标题和摘要汇编出版,~ 采用影印、缩印或者其它方式合理复制学位论文.~

本学位论文属于~(~请勾选~)

(~~)~1.~经华东师范大学相关部门审查核定的~"~ 内部~"~ 或~"~ 涉密~"~ 学位论文~*~, 于\hspace{0.6cm} 年\hspace{0.3cm} 月\hspace{0.3cm} 日解密, 解密后适用上述授权.

(~~)~2.~不保密, 适用上述授权.
\par
\vspace{0.4cm} \hspace*{\fill}  \bf 导师签名:
\rule[-4pt]{2cm}{1pt}\hspace{100pt} 本人签名: \rule[-4pt]{2cm}{1pt}

%\par
%\vspace{0.4cm} \hspace*{\fill} 日期: \qquad 年 \qquad 月\qquad 日}
\vspace{0.4cm}
\hspace{\fill}{年\hspace{1cm}月\hspace{1cm} 日}

\vspace{0.4cm}
\noindent
\scriptsize *~``~涉密~''~学位论文应是已经华东师范大学学位评定委员会办公室或保密委员会审定过的学位论文~(~ 需附获批的
《华东师范大学研究生申请学位论文~``~ 涉密~''~ 审批表》方为有效~),~ 未经上述部门审定的学位论文均为公开学位论文.
此声明栏不填写的,~默认为公开学位论文,~均适用上述授权.~


%------------------------------答辩委员会-----------------------------------------------------------------------
\newpage
\normalsize
\thispagestyle{empty}\vspace*{3cm}
\begin{center}
\begin{tabular}{llllll}
 \Large 张培轩 &{\Large{\hei  硕士学位论文答辩委员会成员名单}}\\ \cline{1-1}\\
\end{tabular}
\end{center}

\begin{center}
\begin{tabular*}{13.2cm}{|p{2cm}|p{2cm}|p{6cm}|p{1.5cm}|}
   \hline
   \rule[-0.35cm]{0pt}{1cm}{\Large\textbf{\hfill 姓\hfill 名}}\hfill\mbox{}&
   \mbox{}\hfill{\Large \textbf{职\hfill称}}\hfill\mbox{}&
   \mbox{}\hfill{\Large\textbf{ 单\hfill 位}}\hfill\mbox{}&\mbox{}\hfill{\Large\textbf{ 备\hfill 注}}\hfill\mbox{}\\
   \hline
 \rule[-0.35cm]{0pt}{1cm}
 \large * \hfill * \hfill * \hfill\hfill&\mbox{}\hfill\large 教 \hfill 授 \hfill \mbox{}&
   \mbox{}\large\hfill \hfill 华东师范大学数学系 \hfill\hfill\mbox{}&
   \mbox{}\large\hfill 主 \hfill 席 \hfill\mbox{\Large\textbf {}}\\
   \hline
   \rule[-0.35cm]{0pt}{1cm}
 \large * \hfill * \hfill * \hfill\hfill&\mbox{}\hfill\large 教 \hfill 授 \hfill \mbox{}&
   \mbox{}\large\hfill \hfill 华东师范大学数学系 \hfill\hfill\mbox{}&
   \mbox{}\large\hfill  \hfill  \hfill\mbox{\Large\textbf {}}\\
   \hline
   \rule[-0.35cm]{0pt}{1cm}
 \large * \hfill\hfill\hfill\hfill * \hfill\hfill&\mbox{}\hfill\large 副 \hfill 教 \hfill 授 \hfill \mbox{}&
   \mbox{}\large\hfill \hfill 华东师范大学数学系 \hfill\hfill\mbox{}&
   \mbox{}\large\hfill  \hfill  \hfill\mbox{\Large\textbf {}}\\
   \hline
\end{tabular*}
\end{center}




\newpage
\pagenumbering{roman}
%\section*{\hspace*{\fill}\Huge {一类具有正向轨道翻转和弱倾斜翻转的异维环分支问题} \hspace*{\fill}}
\section*{\hspace*{\fill}\Huge {一种基于椒盐噪声的自适应}\hspace*{\fill}
\\\hspace*{\fill}\Huge {加权均值滤波算法} \hspace*{\fill}}
\subsection*{\hspace*{\fill}\huge{中\quad 文\quad 摘\quad 要} \hspace*{\fill}}
\vspace*{5mm} \normalfont
本文研究的是图像被椒盐噪声污染后的去噪算法问题。文章首先回顾了去噪椒盐噪声的传统的滤波算法，针对这些算法的局限性与不足，在自适应中值滤波算法的基础上，文章提出了一个新的滤波算法――自适应加权均值滤波算法。算法主要分为检测和去除噪声两个阶段。首先，对于图像的每一个像素，不断扩大窗口的大小，通过判断两个邻近窗口的最值是否分别相等来确定所选定的自适应窗口的大小。如果当前像素点等于所选窗口的最大或最小值时，则判定为噪声点。否则判定为未被污染。然后，噪声点将会被所选定邻域的像素灰度值的一个加权平均值来代替。实验结果表明，本文算法的检测错误率很低并且图像质量较好，且噪声水平越高，效果越显著。
%本文研究的是四维系统中一类具有正向轨道翻转和弱倾斜翻转的异维环分支问题,~ 首先在未扰异维环的小管状邻域内通过建立局部活动坐标架的方法,~ 我们建立了~Poincar\'{e}~ 映射,~ 从而确定了分支方程.~ 通过对分支方程非负解的研究,~ 得到了在微小扰动下,~ 异维环保留和存在条件,~ 同宿环及~1--~ 周期轨的存在性条件,~ 给出了异宿环和同宿环、周期轨的不共存性,~ 异宿环和周期轨的共存性以及~2~ 重~1--~ 周期轨的存在条件,~ 并且获得了相应的分支曲面的近似表达式和共存区域.
%之后,~又通过在未扰异维环的小管状邻域内建立在拉直条件下的局部活动坐标架,~ 同样建立~Poincar\'{e}~ 映射,~ 从而得到拉直条件下的分支方程.~ 通过对分支方程非负解的研究,~ 得到了在微小扰动下,~ 同宿环、周期轨和异宿环三者不共存性,
%周期轨和异宿环的共存性条件.
%讨论最后给出了一个实例来说明文中得到的主要结论.
\\[2mm]

\bfseries{ 关键词:}\normalfont\quad\ ~椒盐噪声,~ 滤波器,~ 噪声检测,~自适应中值滤波,~自适应加权均值滤波

\newpage
\title{{A new adaptive weighted mean filter for salt and pepper noise}}

\thispagestyle{plain}
\section*{\hspace*{\fill}\Large{A new adaptive weighted mean filter }\hspace*{\fill}
\\\hspace*{\fill}\Large{for salt and pepper noise} \hspace*{\fill}}
\subsection*{\hspace*{\fill}ABSTRACT \hspace*{\fill}}
\vspace*{5mm} \normalfont \quad In this letter, we propose a new adaptive weighted
mean filter (AWMF) for detecting and removing high level of
salt-and-pepper noise. For each pixel, we firstly determine the
adaptive window size by continuously enlarging the window
size until the maximum and minimum values of two successive
windows are equal respectively. Then the current pixel is regarded
as noise candidate if it is equal to the maximum or minimum
values, otherwise, it is regarded as noise-free pixel. Finally, the
noise candidate is replaced by the weighted mean of the current
window, while the noise-free pixel is left unchanged. Experiments
and comparisons demonstrate that our proposed filter has very
low detection error rate and high restoration quality especially for
high-level noise.


\vspace*{3mm}

\bfseries{Key words:}\normalfont \quad ~salt and pepper noise,~filter,~noise detection,~adaptive median filter,~adaptive weighted mean filter




\newpage



\thispagestyle{plain}
\section*{\hspace*{\fill}\huge{目\,录}\hspace*{\fill}}
\vspace*{10mm}

\noindent\textbf{\large{中文摘要}\hfill\rmfamily{i} }\\[4mm]
\textbf{\large{英文摘要}\hfill \rmfamily{ii}}\\[4mm]
\textbf{\large{1 绪论}\hfill \rmfamily{1}}\par
\textbf{\large{1.1 研究的目的和意义}$\dotfill 2$}\par
\textbf{\large{1.2 本文所做的工作和内容安排}$\dotfill 3$}\\[4mm]

\textbf{\large{2 理论基础}\hfill \rmfamily{4}}\par
\textbf{\large{2.1 图像噪声模型}$\dotfill 4$}\par
\textbf{\large{2.2 图像质量评价}$\dotfill \textcolor{red}{10}$}\par
\textbf{\large{2.3 算法检测错误率}$\dotfill 11$}\\[11mm]

\textbf{\large{3 椒盐噪声滤波算法回顾}\hfill \rmfamily{13}}\par
\textbf{\large{3.1 中值滤波算法(MF)}$\dotfill 13$}\par
\textbf{\large{3.2 自适应模糊开关中值滤波算法(NAFSMF)}$\dotfill 14$}\par
\textbf{\large{3.3 快速高效算法(FEMF)}$\dotfill 14$}\par
\textbf{\large{3.4 自适应中值滤波算法(AMF)}$\dotfill 15$}\par
\textbf{\large{3.5 自适应中值滤波算法的不足}$\dotfill 15$}\\[4mm]


\textbf{\large{4 本文所提出的算法――自适应加权均值滤波算法}\hfill \rmfamily{17}}\par
\textbf{\large{4.1 自适应加权均值滤波算法}$\dotfill 17$}\par
%\textbf{\large{3.2 自适应中值滤波算法回顾}$\dotfill 6$}\par
%\textbf{\large{3.3 自适应加权均值滤波算法}$\dotfill 16$}\par
\textbf{\large{4.2 实验结果分析}$\dotfill 19$}\\[4mm]

\textbf{\large{5 总结与展望}\hfill \rmfamily{26}}\par
\textbf{\large{5.1 本文工作总结}$\dotfill 26$}\par
\textbf{\large{5.2 工作展望}$\dotfill 26$}\par


\textbf{\large{参考文献}$\dotfill 28$}\\[4mm]
\textbf{\large{致\quad 谢}$\dotfill 32$}\par

\newpage
\pagenumbering{arabic} \pagestyle{fancy} \lhead{\bf\song
华东师范大学硕士论文} \rhead{\song\leftmark1} \cfoot{\thepage}

\section{绪论}
21世纪是一个充满信息的时代，图像作为人类感知世界的视觉基础，是人类获取信息、表达信息和传递信息的重要媒介。
图像是针对客观世界具体事物对象的一种相似性的描述或表示。
广义上来说，图像就是所有具有视觉效果的画面。其蕴藏着大量的信息，并传递着自然界中的能量和事物状态的信息，是人们在平日生活中获取信息的主要媒介之一
\cite{IEEEhowto:Gonzalez}。 因此，图像也可以看做是自然界中的某种状态或者能量在二维空间上的投影，所转化成的一种可视化的形式。
图像对于人类获取外界信息而言，起着相当重要的作用。因此，很多时候，人们总是设法延伸或扩展图像的视觉功能，或者弥补视觉功能的不足。在计算机中，按照颜色和灰度的多少可以将图像分为二值图像、灰度图像、索引图像和真彩色RGB图像四种基本类型。
为了从图像中获取更多的有用的信息，因此，需要对图像进行一定的处理操作。

图像处理(image processing)，近几年来发展非常迅速的一门技术，通过用计算机对图像进行分析、加工和处理，使其能够满足人们某种视觉、心理、艺术以及其他的要求，又称为影像处理。某些情况下，图像处理也可以看作是信号处理在图像域上的一个应用\cite{IEEEhowto:moshishibie}。
近年来，由于计算机技术的快速发展，图像处理被应用于众多的科学与工程领域，如工业检测，遥感，医学，气象，侦察，通信，智能机器人等。广义上来说，文本、图像、视频等都需要借助图像技术才能得到充分利用。图像处理技术一般包括图像压缩，增强和复原，匹配、描述和识别等三个部分\cite{pde}。

根据图像记录方式的不同可以将图像大致分为两大类：模拟图像和数字图像。
模拟图像主要保存图像的亮度信息的途径是通过某种物理量的强弱变化得来的，例如模拟电视图像；
而数字图像则是用计算机来记录图像上各点的亮度信息\cite{pde}。
数字图像是指用工业相机、摄像机、扫描仪等设备经过拍摄得到的一个大的二维数组矩阵。该数组矩阵的元素称为像素，其值称为灰度值。
图像处理也分为模拟图像处理和数字图像处理。
利用光学、照相的方法对模拟图像进行处理成为模拟图像处理。
而数字图像处理，实际上是利用计算机对图像信息进行加工处理，以改善图像的质量、压缩图像的数据或从图像中获取更多的有用信息。在人们日常生活中，大多数的图像都是以数字的形式存储的，因而图像处理很多情况下是指数字图像处理。随着计算机技术的不断进步以及新的理论方法的不断发展，数字图像处理已经成为一门独立的新学科，并有着广泛的应用
\cite{IEEEhowto:imageprocessing}。

在数字图像处理领域里，输入的低质量的图像，输出的是改善质量后的图像。换句话说，也就是将低质量的图像经过一定的算法理论处理后得到质量较高的图像。对于一幅含有噪声的图像，或者被模糊了的图像来说，图像处理的过程实际上就是对图像品质的提升。数字图像处理的内容一般包含预处理、图像去噪、图像恢复、图像增强、图像匹配、模式识别、图像分割、图像分类和图像压缩等。图像去噪是在图像分析和计算机视觉领域中一项十分重要的技术。

到目前为止，图像去噪的主要方法分为两大类：空间域滤波法和频域滤波法。空间域滤波是通过运用模板在图像空间中对图像进行局部操作，每一个像素的取值都是根据模板对输入像素相应领域内的像素值计算而得，空域滤波基本上是让图像在频域空间内某个范围的分量受到抑制，同时保证其他分量不变，从而改变输出图像的频率分布，达到增强图像的目的\cite{IEEEhowto:moshishibie}。
其将领域内的图像像素值同对应的与邻域有相同维数的子图像值相作用，而子图像亦称作：滤波器（filter）、掩膜（mask）、核（kernel）、模板（template）、窗（window）。在空间域中，图像的去噪方法主要有邻域平均法和中值滤波法等。
频域滤波方法是根据相关的数学理论建立的。即法国数学家傅里叶提出：任何周期函数都可以表示为不同频率的正弦或余弦的和的形式法（傅氏级数）；对于非周期函数，则用正弦和余弦及加权函数的积分来表示（傅氏变换）。图像去噪的频率滤波法是将被噪声干扰的信号通过一个滤波器，滤除噪声频率成分。但对脉冲信号、白噪声、非平稳过程信号灯，存在一定的局限性。

数字图像在其形成、传输和记录的过程中，由于成像系统、传输介质和记录设备的不完善等各种原因，往往使得获取的图像受到多种噪声的污染，造成图像质量的下降，因此图像去噪是图像处理中的一个重要问题。

\subsection{研究的目的和意义}
%图像中含有噪声的原因。
%图像去噪的意义。
%图 椒盐噪声，高斯噪声产生的原因及去噪的必要性，像去噪的方法。

由于各种原因，很多时候我们得到的初始图像中含有各种不同类型的噪声。一方面，这些噪声的存在影响着人们对图像的观察；另一方面，它也干扰着人们对图像信息的理解。尤其当噪声水平很高的时候，图像几乎会产生变形，使得图像失去了存储信息的本质意义。显然，对图像进行降噪处理，是正确识别图像信息的必要保证。因此，对图像去噪方法的研究具有极其重要而又深远的现实意义。

椒盐噪声主要来源于成像过程中的短暂停留和数据传输中产生的错误，其对图像质量的破坏性极大。被污染的像素点表现为黑色（胡椒噪声）和白色（盐噪声）。椒盐噪声对图像质量的损害十分严重，即使少量的噪声也会极大地破坏图像的细节，乃至图像的轮廓。因此在模式识别、计算机视觉、图像分析和视频编码等领域，对椒盐噪声图像的前期处理及其重要，其处理效果的好坏将直接影响到后续工作的质量和结果。
%高斯噪声来源于电子电路噪声和低照明或高温带来的传感器噪声，具有密度大、噪声强度的波动范围宽等特点。图像受到高斯噪声污染的程度不仅会随着图像灰度级的变化而改变，而且在同一像素灰度级上也存在着差异，相对于椒盐噪声而言不易于定位和滤除。

对于椒盐噪声，论文首先回顾了许多比较经典的滤波算法――――中值滤波算法(MF)\cite{IEEEhowto:Handbook}，自适应模糊开关中值滤波算法(NAFSMF)\cite{IEEEhowto:NAFSMF}，快速高效滤波算法(FEMF)\cite{IEEEhowto:FEMF}，自适应中值滤波算法(AMF)\cite{IEEEhowto:SaltPepperNoise}。 并针对这些算法的不足和局限性，在自适应中值滤波算法的基础上，提出一个新的滤波算法―――― 自适应加权均值滤波算法(AWMF)。 所提出的自适应中值滤波算法主要分为检测噪声点和恢复噪声点的像素值两个阶段。
对于每一个像素点，在选定的自适应窗口邻域，比较当前像素点与邻域窗口最值的大小来判断其是否为噪声点，并用邻域的加权均值来替代噪声点。实验表明，该自适应加权均值滤波算法在检测错误率和峰值信噪比两方面都优于现有的很多算法，且噪声水平越高，效果越显著。

%针对椒盐噪声和高斯噪声的混合噪声，本文采用自适应加权均值滤波和字典学习中的稀疏表示理论来对被噪声污染的图像进行甄别并去噪，尽可能对图像质量进行有效地恢复。第一阶段，先采用自适应加权均值滤波对被污染图像进行处理，得到一个判断图像像素点是否是噪声点的判断矩阵；再根据字典学习中的稀疏表示理论和判断矩阵建立模型，借助于MATLAB 软件对模型进行求解。实验结果表明，处理后的图像质量较为清晰，算法的检测错误率也是较低的。

\subsection{本文所做的工作和内容安排}
%本文所提出的方法的重要性，可以实现的效果。
%章节安排。
%目录编排。

%阅读和分析了大量的关于椒盐噪声去噪的国内外文献[1-20]。
本文在对各种方法的优缺点进行了分析和实验比较的基础上，针对椒盐噪声的滤除，提出了新的算法―― 自适应中值滤波算法.采用MATLAB 软件进行实验验证，取得较好的实验效果。

论文主要工作有以下几个方面：

%\begin{enumerate}
%  \item 针对椒盐噪声，在自适应中值滤波算法的基础上，提出自适应加权均值滤波算法，并分析比较了几种算法的优劣。
%  \item 针对椒盐噪声和高斯噪声混合噪声，先运用自适应加权均值滤波法进行处理，然后借助于稀疏表示理论，建立去噪模型，并进行求解。恢复后的图像质量有较高的提升。
%\end{enumerate}

针对椒盐噪声，在自适应中值滤波算法的基础上，提出自适应加权均值滤波算法，并分析比较了几种算法的优劣。

论文内容安排如下：

第一章 ~~~绪论，介绍图像去噪研究的目的和意义及本文所做的工作创新点。

第二章 ~~~理论基础，介绍图像的噪声模型，图像质量评价方法和图像检测错误率的概念。

第三章 ~~~回顾椒盐噪声滤波方法的研究进展，分别介绍了中值滤波算法、自适应模糊开关中值滤波算法、快速高效滤波算法、自适应中值滤波器。

第四章 ~~~提出了针对椒盐噪声的自适应中值滤波算法。从检测错误率，时间耗费和图像质量等三个方面来分析算法的优越性。

%第五章 ~~~字典学习理论。介绍稀疏表示理论的背景及模型。
%
%第六章 ~~~椒盐噪声和高斯噪声混合噪声的滤波算法。

第五章 ~~~论文总结和展望。

%附录：本文提出算法的MATLAB M函数

\newpage
\section{理论基础}

图像噪声妨碍人的视觉感知，或干扰了传感器接受图像正常源信息，从而导致理解和分析误差。在信号领域，其也可以理解为真实信号与理想信号之间存在的系统偏差。
噪声可看作是不可预测的随机信号变量，通常采用概率统计的方法对其进行处理分析。

图像产生噪声的原因是多样的。如果按图像产生噪声的原因分类，则可以分为外部噪声和内部噪声。外部噪声，顾名思义，
即指受系统外部干扰以电磁波或经电源串进系统内部而引起的噪声\cite{pde}。
而内部噪声，可以分为以下几种：（1）由光和电的基本性质所产生的噪声。如电流的产生是由电子或空穴粒子的集合，定向运动所形成；（2）由电器的机械运动所导致的噪声；（3）器材材料本身引起的噪声；（4）系统内部设备电路所引起的噪声\cite{IEEEhowto:moshishibie}。图像噪声还可以根据随机过程学理论的角度分为平稳和非平稳噪声。也就是说，当图像噪声的统计特性不因时间的变换而变化的噪声为平稳噪声。反之，其统计特性随时间的变化而变化的噪声称为非平稳噪声。另外，根据概率统计学理论的观点，从图像噪声的统计特性的角度也可以对图像噪声进行分类，常见的噪声类型有高斯噪声，伽马噪声，均匀噪声，指数分布噪声噪声，周期噪声，瑞利噪声和脉冲噪声等。其中，脉冲噪声分为椒盐噪声和随机值噪声两个类型。

数字图像在数字化和传输过程中常受到设备与外部环境的干扰。噪声影响图像处理的输入、采集、处理的各个环节以及输出结果的全过程。在图像处理中，对输入图像的噪声的限制是十分关键的问题。若输入伴有较大的噪声，必然影响全过程及输出的结果。而图像去噪就算指通过一定的算法技术来减少数字图像中噪声的过程。

\subsection{图像噪声类型}

一幅图象在实际应用中可能存在各种各样的噪声。根据噪声对图像的影响，可将其分为两大类:加性噪声和乘性噪声。由于乘性噪声可以通过某种变换而得到加性噪声，因此一般重点研究加性噪声。

设 ~$x$~ 表示原始清晰图象, ~$y$ 表示噪声图象, ~$n$ 表示噪声。加性噪声可表示为 ~$y=x+n$。 图像去噪的目的就是从所得到的降质图像 ~$y$~ 中尽可能地去除噪声 ~$n$，从而还原原始的清晰图像~$x$. 图像去噪就是为了提高图像的质量或清晰度等因素，减少图像的均方误差，使其尽量多地保留原始图像的特征信息，尽可能地接近于原始图像。

数字图像噪声是图像退化的主要原因之一，而噪声的类型也比较多，按图像噪声的统计特性分类，有高斯噪声，瑞利噪声，伽马噪声，指数分布噪声，均匀分布噪声，脉冲噪声等。
数字图像的噪声存在着共同点，这一点可以总结为数字图像噪声的随机性。这种随机性主要体现在两个方面，一方面是图像噪声的幅度的强弱的随机性，
另一方面是这些噪声点在数字图像中的位置分布是随机性的。接下来介绍以下几种重要的噪声模型及其概率密度函数。
%噪声的分类方法是多种多样的。但综合来说，噪声是随机产生的量，所以可以从统计数学的观点来定义噪声。

\subsubsection{高斯噪声}

%所谓高斯白噪声中的高斯是指概率分布是正态函数，而白噪声是指它的二阶矩不相关，一阶矩为常数，是指先后信号在时间上的相关性。这是考查一个信号的两个不同方面的问题。???高斯白噪声：如果一个噪声，它的幅度分布服从高斯分布，而它的功率谱密度又是均匀分布的，则称它为高斯白噪声。??。???短波信道存在多径时延、多普勒频移和扩散、高斯白噪声干扰等复杂现象。为了测试短波通信设备的性能，通常需要进行大量的外场实验。相比之下，信道模拟器能够在实验室环境下进行类似的性能测试，而且测试费用少、可重复性强，可以缩短设备的研制周期。所以自行研制信道模拟器十分必要。

高斯噪声是一类最为常见的噪声之一，它的幅度分布服从高斯分布（即正态分布）。如果它的功率谱密度又是均匀分布的，则称改造时为高斯白噪声。热噪声和散粒噪声是高斯白噪声。
高斯噪声在空间域和频域中具有数学上的易处理性，所以经常被应用于实践中。
高斯噪声随机变量~$z$~的概率分布公式见式（2.1），其中，~$z$~表示灰度值，$\mu$~ 表示~$z$~ 的平均值或期望值，~$\sigma$~ 表示~$z$~ 的标准差。标准差~$\sigma^{2}$，称为$z$ 的方差。当 ~$z$~ 服从式（2.1）分布时，其值有~70\% 落在~$[\mu-\sigma,\mu+\sigma]$ ~范围内，且有~95\% 落在~$[\mu-2\sigma,\mu+2\sigma]$~ 范围内.高斯函数的曲线见图1。

\begin{equation}\label{pdfforGaussN}
  p(z)=\frac{1}{\sqrt{2 \pi} \sigma} \exp{(-\frac{(z- \mu)^{2}}{2 \sigma^{2}})}
\end{equation}

~$z$~表示灰度值，$\mu$~ 表示平均值，$\sigma$~ 表示 ~$z$~ 的标准差。$z$~ 的 ~70\% 的置信区间是~$[\mu-\sigma,\mu+\sigma]$.

\begin{figure}[htp]
\begin{center}
{\includegraphics[width=8cm]{IMG/GaussN_pdf1.eps}}
\caption{\bf{高斯噪声的概率密度函数图像}}
\end{center}
\end{figure}

\subsubsection{伽马噪声}

伽马噪声是概率密度函数服从伽马分布的一类噪声，其概率分布公式见下式，其中~$z$ ~表示灰度值，概率函数函数见图2。

\begin{equation}\label{pdfforGarmmarN}
  p(z)= \left\{
    \begin{array}{ll}
    \frac{a^{b}z^{b-1}}{(b-1)!}e^{-az},& z\geq 0 \\
    0,& z<0 \\
    \end{array}
  \right.
\end{equation}
其中，~$a>0$,~$b$~ 为正整数，且“！”表示阶乘。其密度的均值和方差由下式给出：

\begin{equation}\label{mu}
\mu=\frac{b}{a}
\end{equation}

\begin{equation}\label{si}
 \sigma^{2}=\frac{b}{a^{2}}
\end{equation}


\begin{figure}[htp]
\begin{center}
{\includegraphics[width=8cm]{IMG/GammaN_pdf1.eps}}
\caption{\bf{伽马噪声的概率密度函数图像}}
\end{center}
\end{figure}

\subsubsection{指数分布噪声}
指数分布噪声的密度函数可由下式给出：

\begin{equation}\label{pdfforexpN}
  p(z)= \left\{
    \begin{array}{ll}
    ae^{-az},& z\geq 0 \\
    0,& z<0 \\
    \end{array}
  \right.
\end{equation}
这里，$a>0$。概率密度函数的期望值和方差如下：

\begin{equation}\label{mu}
\mu=\frac{1}{a}
\end{equation}

\begin{equation}\label{si}
 \sigma^{2}=\frac{1}{a^{2}}
\end{equation}
由密度函数可以看出，指数分布的概率密度实际上是 ~$b=1$~ 时伽马分布的特殊情况。

\subsubsection{均匀噪声}

均匀噪声是概率密度函数服从均匀分布的一类噪声，其概率分布公式如下式，其中~$z$~ 表示灰度值，概率函数函数见图3。

\begin{equation}\label{UniformN}
  p(z)= \left\{
    \begin{array}{ll}
    \frac{1}{b-a},& a\leq z \leq b \\
    0,& otherwise \\
    \end{array}
  \right.
\end{equation}
概率密度函数的期望值和方差如下：
\begin{equation}\label{mu}
\mu=\frac{a+b}{2}
\end{equation}

\begin{equation}\label{si}
 \sigma^{2}=\frac{(b-a)^{2}}{12}
\end{equation}

\begin{figure}[htp]
\begin{center}
{\includegraphics[width=8cm]{IMG/UniformN_pdf1.eps}}
\caption{\bf{均匀噪声的概率密度函数图像}}
\end{center}
\end{figure}

\subsubsection{泊松噪声}

在随机过程的一个周期内，泊松分布统计模型如下式，

\begin{equation}\label{pdfforPoissonN}
  p(k,\lambda)= e^{-lambda}\lambda^{k}/k!
\end{equation}

其中~$k$~表示单位时间内随机事件的个数，~$\lambda$~ 即是随机事件的均值，也是其方差。所以泊松过程有其方差等于其均值的性质，即~$\sigma^{2}=\mu$~. 因此，泊松分布的信噪比定义为

\begin{equation}\label{1}
  SNR=\mu / \sigma=\mu/\sqrt{\mu}=\sqrt{mu}
\end{equation}

也就是说，在有泊松噪声构成的图像中，其信噪比跟泊松噪声自身的均方根成正比。在加性噪声模型中，噪声跟信号是相互独立的。

\subsubsection{椒盐噪声}


脉冲噪声分为椒盐噪声和随机值脉冲噪声两类。它是一种非连续的噪声，持续时间短，且由幅度大的不规则脉冲或噪声尖峰组成。
脉冲噪声在图像上的空间分布是随机的，有均匀分布的，也有非均匀分布的。本文所提及的椒盐噪声是专指均匀分布的脉冲噪声。
产生脉冲噪声的原因有很多，包括电磁干扰以及通信系统的故障和缺陷，也可能是因为通信系统的电气开关和继电器状态改变时产生的。

椒盐噪声又称为双极性脉冲噪声，一般是由图像传感器，传输信道，解码处理等产生的黑白相间的亮暗点噪声，像是随机分布在图像上的胡椒粉和盐粉。

记 ~$x$~ 表示原始的清晰图像，图像大小为 $M\times N$. 自然地 ~$x_{i,j}$~ 就表示图像 ~$x$~ 中坐标为~$(i,j)$~ 位置像素的灰度值，此处 ~$(i,j)\in A\equiv\{1,...,M\}\times\{1,...,N\}$. ~令 ~$[s_{min},s_{max}]$~ 表示图像 ~$x$~ 中像素所取的灰度值的区间,所以有 ~$s_{min}\leq x_{i,j} \leq s_{max}$.~ 当图像 $x$ 被椒盐噪声污染时，像素点的灰度值变为 ~$s_{min}$~ 或 ~$s_{max}$.~ 所以污染后的图像 $y$ 的坐标为$(i,j)$ 的像素的灰度值~$y_{i,j}$ ~，其表示如下。

\begin{equation}\label{modeforSPN}
  y_{i,j}= \left\{
    \begin{array}{l}
    s_{min},\ \ \ \ \  with \   probability\ \ \ \ \ p \\
    s_{max},\  \ \ \  \  with \   probability\ \ \ \ \ q \\
    x_{i,j},\ \ \ \ \ \ \  with \   probability\ \ \  1-p-q \\
    \end{array}
  \right.
\end{equation}

这里 ~$r=p+q$~ 定义为椒盐噪声的噪声水平. 本文中令~ $p=q$~ .椒盐噪声的概率分布公式如下，其中~$z$~ 表示灰度值，概率函数函数见图4。

\begin{equation}\label{PDFforSPN}
    p(z)= \left\{
    \begin{array}{ll}
    p_{a} & z=a \\
    p_{b}  & z=b \\
     0    & otherwise \\
    \end{array}
  \right.
\end{equation}

在椒盐噪声的概率密度公式中，如果~$P_{a}$~或~$P_{b}$~为零，则脉冲噪声成为单极性脉冲噪声。如果~$P_{a}$ 和~$P_{b}$ 均不为零，通常可设~$b>a\geq 0,a,b$ ~都是饱和值,也就是说它们等于所允许的最小值和最大值。即对于一个8位图像来说，有~$a=0$~(黑点), ~$ b=255$ （白点）.

\begin{figure}[htp]
\begin{center}
{\includegraphics[width=8cm]{IMG/SPN_pdf1.eps}}
\caption{\bf{椒盐噪声的概率密度函数图像}}
\end{center}
\end{figure}
%
%\begin{figure}[ht]
%\begin{center}
%%\captionsetup{textfont=small}
%\subfigure[Gauss Noise]{\includegraphics[width=6cm]{IMG/GaussN_pdf.eps}}
%\subfigure[Gamma Noise]{\includegraphics[width=6cm]{IMG/GammaN_pdf.eps}}\\
%\subfigure[Uniform Noise]{\includegraphics[width=6cm]{IMG/UniformN_pdf.eps}}
%\subfigure[Salt-and-pepper Noise]{\includegraphics[width=6cm]{IMG/SPN_pdf.eps}}
%\end{center}
%\captionsetup{textfont=small}
%\caption{\bf{噪声的概率密度函数图像.}}\label{fig:fig3}
%\end{figure}

\subsubsection{随机值脉冲噪声}

虽然椒盐噪声模型较为简单，且便于分析和处理。目前针对去除椒盐噪声的算法理论有很多，且滤波的效果也较好。但现实中的脉冲噪声往往不会只有两个极值点，下面介绍一种较为常见的噪声模型―――― 随机值脉冲噪声，其模型如下。

\begin{equation}\label{modeforRVN}
    y_{i,j}= \left\{
    \begin{array}{ll}
    r & with\ probability \ \ p\\
    x_{i,j}  & with\ probability \ \ 1-p \\
    \end{array}
  \right.
\end{equation}

其中，$p$ 是随机值脉冲噪声的噪声水平，$r \in [s_{min},s_{max}] $ ~是灰度级上均匀分布的整数。这类噪声模型比起椒盐噪声要更为符合实际情况，且现在已有很多关于此类噪声模型的研究。

\subsection{图像质量评价}

图像质量的概念包含两个方面，一个是图像的逼真度，即被评价图像与标准图像的偏离程度。另一个是图像的可懂度，即图像能够向人或机器提供信息的能力。
通过对图像质量的评价，可以对图像的获取、传输和处理分析等各环节技术的优劣提供一定的参考标准。

目前，对图像质量如何进行准确评价的研究也已经成为图像信息工程的基础技术之一。常用的评价方法有两种，即主观评价法和客观评价法。
由于客观评价法中，目前尚无一种既十分恰当精确又完全符合主观效果的评价方法。因此，通常情况下还需要主观观察图像来进行辅助评价。

\subsubsection{客观评价方法}

图像质量的客观评价方法通常分为全参考图像质量评价、半参考图像质量评价和无参考图像质量评价，这是基于原始图像来评价图像质量的划分方法。全参考图像质量评价方法中，目前主要采用误差评价法，根据恢复后的失真图像与原始图像信息的吻合程度来计算的。常用的评价标准有均方误差(MSE)，平均绝对误差(MAE)，信噪比(SNR) 和峰值信噪比(PSNR)等。

用符号~ $x$~ 表示原始清晰图象, $y$ 表示噪声图象，~$x(i,j),y(i,j)$~ 意义同上， 图像大小为~ $M\times N$~。

(1)均方误差

\begin{equation}\label{MSE}
    MSE=\frac{1}{MN}\sum\limits_{i=1}^{M} \sum\limits_{j=1}^{N}[x(i,j)-y(i,j)]^{2}
\end{equation}

(2)平均绝对误差

\begin{equation}\label{MAE}
    MAE=\frac{1}{MN}\sum\limits_{i=1}^{M} \sum\limits_{j=1}^{N} |x(i,j)-y(i,j)|
\end{equation}

(3)信噪比

\begin{equation}\label{SNR}
    SNR=10\times lg[\frac{\sum\limits_{i=1}^{M} \sum\limits_{j=1}^{N} x(i,j)^{2}}{\sum\limits_{i=1}^{M} \sum\limits_{j=1}^{N} [x(i,j)-y(i,j)]^{2}}]
\end{equation}

(4)峰值信噪比

\begin{equation}\label{PSNR}
    PSNR=10\times lg[\frac{ MN [x_{max}(i,j)]^{2}}{\sum\limits_{i=1}^{M} \sum\limits_{j=1}^{N} [x(i,j)-y(i,j)]^{2}}]
\end{equation}

\subsubsection{主观评价方法}

图像质量的主观评价方法主要是运用对比观察的方式，通过对比结果图像和原始图像，对比结果图像和噪声图像等来对滤波器或去噪算法进行主观评价。由于噪声污染会产生某种程度的信息丢失，因此在进行主观评价时，不可过度地追求结果图像与原始图像的一致性。

一般来说，主观评价方法可以从以下两个方面进行分析：

\begin{enumerate}
  \item 观察画面的平滑效果。主要可对图像的平坦区、缓变区等区域块进行评价观察。
  \item 观察画面结果成分的保护效果。每一种噪声滤波方法在平滑噪声的同时，都会或多或少地对图像的结构成分如图像的边缘产生破坏或导致扭曲。大部分滤波方法的结构破坏常常体现为边缘模糊，边缘扭曲及细节丢失等。
\end{enumerate}

评价滤波方法的好坏需要综合考虑平滑效果和细节保护两方面因素。判断图像的质量时，通常采用主观评价法与客观评价法相结合的方式进行评价。

\subsection{算法检测错误率}

在对图像进行去噪的过程中，很多算法都还会包含有一个检测阶段：即对图像的每一个像素点进行分析与判断，判断其是否为被噪声污染过，即噪声点。这个检测阶段的检测错误率很多时候也可以作为衡量一个算法优劣性的指标。本文将采用这个指标来对椒盐噪声滤波算法进行综合评价。符号 ~$x,~y$ ,~$x(i,j), ~y(i,j)$~ 的意义同上，假设图像大小仍为 ~$M\times N$~。 符号 ~$z$~ 表示对噪声图像，~ $y$~ 运用某种滤波算法恢复后得到的图像， ~$z(i,j)$~ 表示图像~$z$~ 的像素点。所以算法检测错误率的定义如下：

\begin{equation}\label{eq:6}
  Error\ Rate = \frac{C}{MN}\times 100\%
\end{equation}
%\begin{equation}\label{eq:7}
%  C = \{(i,j)\in A:(x_{i,j}\neq z_{i,j})\}
%\end{equation}
其中符号 ~$C$~ 表示恢复后的图像 ~$z$~ 和原始清晰图像 ~$x$~ 中灰度值 ~$z(i,j)\neq x(i,j)$~ 的像素点个数。


%\subsection{稀疏表示理论}
%
%信号稀疏表示是过去近20年来信号处理界一个非常引人关注的研究领域，众多研究论文和专题研讨会表明了该领域的蓬勃发展。信号稀疏表示的目的就是在给定的超完备字典中用尽可能少的原子来表示信号，可以获得信号更为简洁的表示方式，从而使我们更容易地获取信号中所蕴含的信息，更方便进一步对信号进行加工处理，如压缩、编码等。
%
%
%
%%首先，单一小波系数的稀疏性已经研究过，产生出著名的收缩算法。转向冗余表示的一个目的是有可转换的不变式性质。并且，因为逐渐意识到运用正规一维小波变换来处理图像已变得不合适，一些新的特制的多尺度和方向冗余变换被引进来了，包括曲线波，轮廓波，楔形波，细带波，可操作的小波。同时，匹配追逐和基本追踪去噪方法再加上基于冗余字典的系数分解技术的引进，提高了处理图像噪声问题的能力，因此，今天对于一些稀疏问题，我们开始考虑一些最优的，可运用性的去噪方法。
%%
%%当一些研究工作建立在稀疏和冗余概念上时，需要从另外一个角度，从另外一些新发表的有关图片恢复的文献中来处理。图像处理中，运用贝叶斯方法在处理一般性的求逆问题时，需要确定图像优先级。习惯上，这个问题已经解决，通过简化假设选取优先级，比如空间平滑，最大最小熵，在变换域上的稀疏。当这些常用的方法依托在一个图像优先级的数学表达式的猜想上时，基于图片例子的技术表明应该多少学习下图像处理中的优先级。例如，假设一个特定结构的空间平滑的马尔科夫随机优先值，仍然可以在此基础上提出或训练成派生滤波器应用在图像上，和鲁棒性函数来测算这些滤波器的结果。
%%
%%当这些优先级的学习思想和稀疏冗余表示整合在一块时，只有运用字典我们才能锁定学习的参数集合。不是重新配置预先选取的基本函数集，因为曲线波或者轮廓波会做这些事，我们只是提出从图形例子中进行字典学习。在这类工作中，我们选取两种字典训练方式：1）用被污染的函数本事的图像块来训练字典，2）用一个从高质量的图像集中训练出的图像块的资料库。
%%
%%这种字典学习的思想用来稀疏表示一个图像块集合，这些研究现在已经完成了一系列的工作。本文采用K-SVD 算法，因为它的简单及高效性。并且我们将看到，因为其内在的结构，当字典训练在一个给定的图像上直接完成时，它如何将训练字典和去噪过程自然地结合成一个连贯的迭代计算过程。
%%
%%因为字典学习在处理小图像块上的局限性，一个自然地问题产生：怎样才能将它运用在一般的任意大小的图像上呢？在这方面，本文运用了一个全局的图像优先级，确保可以稀疏表示图片每一个位置上的重叠的图像块。在文献\cite{IEEEhowto:OMP}中出现的这种类似的匹配思想，是为了将一个局部的基于MRF 优先级转换成全局的优先级。我们将最大后验概率估计定义为全局的定义完备的惩罚函数的最小值。它的数值解产生出一个简单的迭代的块之间的稀疏代码和与文献\cite{IEEEhowto:Weighted}, \cite{IEEEhowto:Nonlinear} 关联紧密的平均算法，并推广算法。
%%
%%当考虑到全局的和多维度的可代替的去噪主题，它似乎是在小块图像处理上丢掉了很多。有可能得到一个在局部稀疏表示方面相同的去噪效果吗？在那个方面，文献 \cite{IEEEhowto:scale} 提到的图像去噪工作是很有用处的。那篇文章除了介绍特定的方法和高效的算法外，portilla 和他的同事们提出了一个关于界定图像处理方法应该如何被采用并相互比较的实验的清晰的集合概念。我们充分利用这些精确地实验并说明新提出的算法运行起来简便易行，而且，优于其他的去噪算法。
%
%\subsubsection{稀疏表示}
%
%图像处理、信息传输、计算机视觉等诸多领域一直在寻求信号与图像的稀疏而简洁的表示方式。这种稀疏表示的好处就在于，非零稀疏揭示了信号与图像的内在结构与本质属性，同时非零系数具有显式的物理意义。
%所谓稀疏表示，从数学的角度来说，就是用尽量少的基函数来进行表示的过程。对于给定的数字图像$u\in R^{N}$, 其大小为$\sqrt(N)\times \sqrt(N)$, 字典$D$ 为$L $个 $N$ 为单位长度向量$d_{\gamma}$的集合，即
%
%\begin{equation}\label{dict}
%  D={d_{\gamma}\in R^{N}| ||d_{r}||=1, 1\leq \gamma\leq L}
%\end{equation}
%其中$D $ 的每个元素$d_{\gamma}$ 称为字典原子。在给定字典的情况下，我们可以将图像$u$ 可分解为该字典中各原子的线性组合形式：
%
%\begin{equation}\label{1}
%  u=\sum\limits_{\gamma=1}^{L} \alpha_{\gamma}d_{\gamma}
%\end{equation}
%
%
%也可以采用逼近形式分解为：
%
%\begin{equation}\label{3}
%  u=\sum\limits_{\gamma=1}^{M} \alpha_{\gamma}d_{\gamma}+ R^{(M)}
%\end{equation}
%
%其中，$\alpha={\alpha-{\gamma}, 1\leq \gamma \leq L}$为图像 $u$ 在字典$D$ 下的分解系数，$R^{(M)}$ 是经过$M$项逼近后的残差项。如果字典$D$ 中原子能够张成$N$维欧式空间$R^{N}$, 即$span{d_{\gamma}\in D}=R^{N}$, 则称$D$是完备的字典；当原子个数$L>N$ 时，字典$D$是冗余的，如果同时还能够张成$N$ 维欧式空间-$R^{N}$,则称此时的字典是过完备的，在这种字典基础上的分解稀疏$\alpha$ 是不唯一的，我们可以根据应用的目的选择最为合适的表示系数。一般地，可以从众多分解系数中选取最为稀疏的系数，可采用$L_{0}$ 范数进行度量，可以建立如下的图像过完备稀疏表示模型：
%
%


\newpage
\section{椒盐噪声滤波方法回顾}

从图像分析的流程角度来说，图像滤波可以算得上是对图像的预处理。但从数字图像处理技术的角度来说，它又属于图像恢复的技术范畴。图像滤波实际上就是如何利用图像的噪声点所在的领域内的其他的非噪声点的灰度值经过某种计算得到当前噪声点的像素灰度值的过程，并且，使得该值尽可能地接近未被噪声污染前的原始图像中该点的值，视觉上就表现为滤波后的图像与原始图像具有极高的相似性。

本文所研究的问题是针对被椒盐噪声污染的图像进行降噪。目前，已有大量的文献来研究如何去除图像中的椒盐噪声[1-12]。经典的中值滤波方法是由J.W.Jukey在1971 年提出来的一种非线性的滤波方法。
此外，还有自适应模糊开关中值滤波算法(NAFSMF)\cite{IEEEhowto:NAFSMF} ，快速高效滤波算法(FEMF)\cite{IEEEhowto:FEMF}，自适应中值滤波算法(AMF) 等。

本文将对这些滤波算法进行介绍，并在自适应中值滤波算法的基础上提出一个新的滤波方法――――自适应加权均值滤波法(AWMF)。
通过运用MATLAB 软件对实验结果进行分析比较，发现所提出的自适应加权均值滤波算法优于很多现存的其他滤波算法。

\subsection{中值滤波算法(MF)}

中值滤波对椒盐噪声有良好的滤除与限制作用，特别是在滤除噪声的同时，能够保留很多细节及边缘，使之不会变得模糊。
而这些滤波的好处是传统的线性滤波方法所不具有的。此外，中值滤波的算法比较简单，也易于用软件实现。所以，一经提出，中值滤波方法便在数字信号处理领域得到了极大的重视，并得到了重要而广泛的应用。

中值滤波法是一种非线性平滑技术，它将被噪声污染的图像的每一个当前像素点的灰度值，设置为该点所在的某个邻域窗口内的所有像素点灰度值的中值。并且，中值滤波算法对图像的所有像素点都进行处理，而且每一个像素点所选取的窗口大小是相同的。公式表示如下:

\begin{equation}\label{3}
  z(i,j)=median\{y(i-s,j-t),(s,t\in W)\}
\end{equation}
~$z$~表示经滤波算法恢复后的图像，~$y$~ 表示含有噪声的图像，~$W$~ 表示二维模板，通常为以当前像素位置~$(i,j)$~ 为中心的 ~$3\times 3$~， 或 ~$5\times 5$~ 的窗口或区域，也可以是不同的形状，如线状，圆形，十字形，圆环形等。

虽然，中值滤波方法对椒盐噪声有较好的滤除作用，但同时也存在着很大的盲目性与固定性。即对于所有的像素点都采用同样的方法，并没有有针对性地对像素点进行筛选，并且每个像素点都是采取同样大小的窗口进行赋值的。其在滤除噪声点的同时，也改变了一些信号点的像素值。

\subsection{自适应模糊开关中值滤波算法(NAFSMF)}

%经典的中值滤波算法中，所选取的当前像素点的窗口的大小是固定不变的。但是，在对图像进行处理的时候，有些像素点所处的位置比较平滑，有些像素点所处的位置可能恰好处于边缘地带，所以不同的像素点应当选取不同大小的窗口。
对于椒盐噪声而言，通常情况下，不是所有的像素点都需要进行处理并赋值的。
自适应模糊开关中值滤波算法\cite{IEEEhowto:NAFSMF}对椒盐噪声的处理包含了两个阶段，即检测阶段和赋值阶段。

在算法的检测阶段中，该算法根据被污染图像的像素值的直方图对图像的像素点进行检测，检测其是否为噪声点。如果当前像素点的灰度值恰好等于灰度值的最小或最大值时，则标记当前像素点为噪声点。

在算法的赋值阶段中，如果当前像素点被判断为非噪声点，则不做任何处理；否则，
将当前像素值和所在邻域的中值进行加权平均，再进行赋值。并且，这里，邻域窗口的大小不是固定的，是可以改变的，故称之为“自适应”。
这也就弥补了中值滤波算法限定窗口大小的不足。

符号~$y_{ij}$~表示噪声图像的当前像素点~$(i,j)$~ 的灰度值，~$z_{ij}$~表示恢复后的图像的当前像素点~$(i,j)$~ 的灰度值。~$L_{salt}=255$~ 和 ~$L_{pepper}=0$~ 用于判断当前像素点是否为噪声点，用矩阵~$N$~来标记。

自适应模糊开关中值算法的算法流程见“Algorithm 1”。

\begin{algorithm}[htb]
\begin{minipage}{17cm}
对噪声图像~$y$~ 和恢复后的图像 ~$z$~ 中的当前像素点 ~$(i,j)\in A$~ 来说，
\begin{enumerate}
\item
初始化 设定两个阈值~$T_{1}=10$,~$T_{2}=30$~, 窗口大小~$w=3$~, ~$L_{salt}=255$~, ~$L_{pepper}=0$~。
\item
检测噪声点阶段：

如果~$y_{i,j}=L_{salt}$,~ 或~$y_{i,j}=L_{pepper}$,~ 则判断~$N(i,j)=1$,\\
否则标记~$N_{i,j}=0$.~
\item
对~$N(i,j)=1$~的像素点赋值：

计算
~$M(i,j)=median\{y(i-1,j-1),~~ y(i,j-1),y(i+1,j-1),y(i-1,j)\}$,\\
 ~$d(i+s,j+t)=|y(i+s,j+t)-y(i,j)|$ ~ 和 ~$D(i,j)=max\{d(i+s,j+t)\}$. \\
 ~这里~$(i+s,j+t)\in W$,~ $W$~ 为当前窗口。
\item
计算
\begin{equation}\label{1}
F(i,j)=\left\{
\begin{array}{cc}
0,& D(i,j) < T_{1} \\
\frac{D(i,j)-T_{1}}{T_{2}-T_{1}}, & T_{2}\leq D(i,j)<T_{2}\\
1,& D(i,j)\geq T_{2}
\end{array}
\right.
\end{equation}
然后赋值：\\
$z(i,j)=[1-F(i,j)]\cdot y(i,j) + F(i,j)\cdot M(i,j)$.
\end{enumerate}
\end{minipage}\\
\caption{\bf{自适应模糊开关中值滤波算法(NAFSMF)}}
\end{algorithm}

\subsection{快速高效滤波算法(FEMF)}

快速高效滤波算法\cite{IEEEhowto:FEMF}也可以用来对椒盐噪声进行滤除，同样它也包含有两个阶段：检测阶段和赋值阶段。检测阶段的思路与自适应模糊开关中值滤波算法(NAFSMF)的相同。

在该算法的赋值阶段过程中，该算法是采用当前像素点所在邻域的中值来对噪声点进行赋值的。但是，选取窗口的形式也与预估的椒盐噪声水平的高低有关。当椒盐噪声水平预估高于50\%时，窗口采取为方形领域，否则，窗口采取十字形的形式。并且，同样窗口的大小也不是固定的，是可以调整的，自适应的。

同样，符号~$y_{ij}$~表示噪声图像的当前像素点~$(i,j)$~的灰度值，~$z_{ij}~$表示恢复后的图像的当前像素点~$(i,j)$~ 的灰度值。~$L_{salt}=255$~ 和 ~$L_{pepper}=0$~ 用于判断当前像素点是否为噪声点，用矩阵~$N$~ 来标记。

快速高效算法的算法流程件“Algorithm 2”。

\begin{algorithm}[htb]
\begin{minipage}{17cm}
对噪声图像 $y$ 和恢复后的图像 $z$ 中的当前像素点 $(i_{1},j_{1})$ 来说，
\begin{enumerate}
\item
初始化 设定窗口大小$w=3$, 噪声水平预估为 $E$, $L_{salt}=255$, $L_{pepper}=0$。
\item
检测噪声点阶段：

i 如果$y_{i,j}=L_{salt}$, 或$y_{i,j}=L_{pepper}$, 则判断$N(i,j)=1$,\\
否则标记$N_{i,j}=0$.

ii 如果$E\leq 50$,令:\\
$S=\{(i_{1},j_{2}):~j_{2}=i_{2}\pm (w-1)/2\} \bigsqcup
\{(j_{1},i_{2}):~j_{1}=i_{1} \pm (w-1)/2\} $,\\
否则，令\\
$S= \{(j_{1},j_{2})|i_{1}-(w-1)/2 \leq j_{1} \leq i_{1}+(w-1)/2,j_{2}=i_{2}\pm (w-1)/2\}\bigsqcup\\
\{(j_{1},j_{2})|i_{2}-(w-1)/2 \leq j_{2} \leq i_{2}+(w-1)/2,j_{1}=i_{1}+(w-1)/2\}$。

\item
如果~$S$~中不包含非噪声点，即~$N(i,j)=0, \forall(i,j)\in S$~, 则~$w=w+2$~, 转到2.\\
否则，~$H$~ 表示~$S$~中所有非噪声点的集合，令~$z(i_{1},j_{1})=median\{H\}$。

\end{enumerate}
\end{minipage}\\
\caption{\bf{快速高效滤波算法(FEMF)}}
\end{algorithm}

%
%\begin{figure}
%  \centering
%  % Requires \usepackage{graphicx}
%  \includegraphics[width=20cm]{IMG/FEMF.eps}\\
%  \caption{快速高效滤波算法(FEMF)}\label{femf}
%\end{figure}

\subsection{自适应中值滤波算法(AMF)}

符号~$y,~z,~y_{i,j},~z_{i,j}$~用法同时，现记符号~$S_{i,j}(w)$~大小为 ~$(2w+1)\times(2w+1)$~， 表示以 ~$(i,j)$~ 为中心的窗口，~$w$~ 表示窗口半径,即
\begin{equation}\label{eq:2}
  S_{i,j}(w)=\{(k,l):~|k-i|\leq w,|l-j|\leq w,(k,l)\in A \}
\end{equation}
符号 ~$S_{i,j}^{min}(w)$, ~$S_{i,j}^{med}(w)$~ 和 ~$S_{i,j}^{max}(w)$~ 分别表示当前窗口 ~$S_{i,j}(w)$~ 的最小值，中值和最大值。 自适应中值滤波法通过增大窗口的大小来检测当前像素点是否为噪声点。 如果当前像素是噪声点，则需要用自适应窗口的中值来代替；否则不需要改变。符号 ~$z$~ 表示恢复后的图像。

自适应中值滤波算法见“Algorithm 3”。

\begin{algorithm}[htb]
\begin{minipage}{17cm}
对噪声图像 $y$ 和恢复后的图像 $z$ 中的当前像素点 $(i,j)\in A$ 来说，
\begin{enumerate}
\item
初始化 $w=1$,$h=1$,$w_{max}=39$.
\item
 计算 $S_{i,j}^{min}(w), S_{i,j}^{med}(w)$, and $S_{i,j}^{max}(w)$.
\item
若满足 $S_{i,j}^{min}(w) < S_{i,j}^{med}(w) < S_{i,j}^{max}(w)$, 则转到第 5 步; 否则, $w=w+h$.
\item
若满足 $w\leq w_{max}$, 则转到第 2 步; 否则 $z_{i,j} = S_{i,j}^{med}(w_{max})$, 结束.
\item
若满足 $S_{i,j}^{min}(w) < y_{i,j} < S_{i,j}^{max}(w)$, 则判断像素点 $(i,j)$ 未被污染,令 $z_{i,j} = y_{i,j}$ \\
否则令 $z_{i,j} = S_{i,j}^{med}(w)$, 结束.
\end{enumerate}
\end{minipage}\\
\caption{\bf{自适应中值滤波算法(AMF)}}
\end{algorithm}

\subsection{自适应中值滤波算法的不足}

一般来说，在噪声水平较高的情况下，自适应中值滤波法的去噪效果依然还是不错的。然而该算法仍然有两个缺陷。第一个缺陷是，自适应中值滤波法会导致较高的检测错误率；如果当前像素点没有被噪声污染，但是它的灰度值等于局部窗口的最小值或最大值，由算法1 中的第5 步可知，当前像素点仍然会被误测为噪声点，从而导致检测错误。图5 给出了一个大小为 ~$7\times7$~ 的窗口实例，当前点为中心元素，其灰度值为66。 在以当前点为中心的大小为~$3\times3$~ 窗口中，~$S_{i,j}^{min}(1)=66,~ S_{i,j}^{med}(1)=78,~ S_{i,j}^{max}(1)=255$,~ 算法第~3~步条件成立，但第~5~步条件不成立，所以当前点会被误判为噪声点，被~$3\times3$ ~窗口的中值 78 所代替，进而产生检测错误。另一个缺陷是，当噪声水平很高时，恢复后的图像会丢失很多的细节或边缘信息。为了克服自适应重质量滤波算法的缺陷，提高恢复后图像的质量，本文提出一个新的滤波算法――自适应加权均值滤波法。

\begin{figure}[htb]
\renewcommand{\arraystretch}{1.3}
\addtolength{\tabcolsep}{-1pt}
\centering
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
0 & 68 & 255 & 0 & 0 & 70 & 255\\
\hline
0 &  255 &  255 &255 &  255  & 255 & 0\\
\hline
0 &   255  & 68 & 67   & 67   &255 & 0\\
\hline
255 & 0& 255 &  \textbf{66} &  78 &  255 & 70 \\
\hline
255&  0 &255  &255   &255  & 255 & 255 \\
\hline
0 & 255 &0 & 255&     0  &   0&  0 \\
\hline
0 & 78&  0&  0 & 255&  255&  255\\
\hline
\end{tabular}
\caption{{\bf{窗口实例(AMF对中心点产生误判)}}}
\label{figure 2}
\end{figure}


\newpage
\section{自适应加权均值滤波方法}

\subsection{自适应加权均值滤波方法(AWMF)}

为了提高自适应中值滤波法的去噪效果，并根据AMF算法的工作机制，本文提出自适应加权均值滤波算法。
该算法的主要目的是减少检测错误并用一个比窗口中值较接近真实值的量来代替噪声点。

首先，引入一个新的符号 ~$S_{i,j}^{mean}(w)$~ -- 选定窗口~ $S_{i,j}(w)$~ 的加权均值-- 定义如下：

\begin{equation}\label{30}
   S_{i,j}^{mean}(w)= \left\{
    \begin{array}{cc}
    \frac{\sum\limits_{(k,l)\in S_{i,j}(w)} w_{k,l}*y_{k,l}}{\sum\limits_{(k,l)\in S_{i,j}(w)} w_{k,l}} & \sum\limits_{(k,l)\in S_{i,j}(w)}w_{k,l} \neq0\\
    -1 &  otherwise  \\
    \end{array}
  \right.
\end{equation}

\begin{equation}\label{31}
  w_{k,l}=\left\{\begin{array}{cc}
             1, &  S_{i,j}^{min}(w) < y_{k,l} < S_{i,j}^{max}(w) \\
             0. & otherwise \ \ \ \ \ \\
           \end{array}
           \right.
\end{equation}
仍用符号 ~$z$~ 表示恢复后的图像. 所提出自适应加权均值滤波算法如下。


\begin{algorithm}
\begin{minipage}{17cm}
对噪声图像 $y$ 和恢复后的图像 $z$ 中的当前像素点 $(i,j)\in A$ 来说，
\begin{enumerate}
\item
初始化~ $w=1$, $h=1$, $w_{max}=19$.
\item
计算~ $S_{i,j}^{min}(w)$, $S_{i,j}^{max}(w)$, $S_{i,j}^{mean}(w)$, $S_{i,j}^{min}(w+h)$ 和 ~$S_{i,j}^{max}(w+h)$.

\item
如果 `$S_{i,j}^{min}(w)=S_{i,j}^{min}(w+h)$, $S_{i,j}^{max}(w)=S_{i,j}^{max}(w+h)$~ 和 ~$S_{i,j}^{mean}(w)\neq -1$, \\

转到第 5 步;否则令 ~$w=w+h$.
\item
如果 ~$w\le w_{max}$, ~转到第 2步; 否则令 ~$z_{i,j}=S_{i,j}^{mean}(w)$, ~ 结束.
\item
如果 ~$S_{i,j}^{min}(w)<y_{i,j}<S_{i,j}^{max}(w)$,~ 则判断~$(i,j)$ ~未被污染, ~$z_{i,j}=y_{i,j}$ \\

否则判断 ~$(i,j)$~ 被噪声污染,令 ~$z_{i,j}=S_{i,j}^{mean}(w)$,~ 结束.
\end{enumerate}
\end{minipage}\\
\caption{\bf{自适应加权均值滤波法(AWMF)}}
\end{algorithm}

接下来给出所提出算法的详细解释。对于当前像素点来说，首先要确定自适应窗口的大小。即不断地扩大窗口的尺寸，直到出现两个相连续的窗口的最大值和最小值分别相等为止，把尺寸较小的窗口定义为当前点的自适应窗口。然后，如果当前点的灰度值等于自适应窗口的最大值或最小值，则当前点被判断为噪声点；否则当前点未被污染。结果表明，即便噪声水平很高时，仍然可以大大地降低检测错误率。图2 中，中心点为66，由于两个连续的~$5\times 5$ 和 ~$7\times7$ 的窗口的最大值(=255) 和最小值(=0) 分别对应相等，所以自适应窗口大小为 ~$5\times 5$。 因为当前点灰度值~66 不等于~255 或~ 0，所以当前点被判为未被噪声污染。因此，对这个例子来说，自适应加权均值滤波算法的检测结果是正确的，而自适应中值滤波算法的检测结果是错的\cite{IEEEhowto:AWMF}。

在自适应加权均值滤波算法中，检测后的噪声点将被当前所选定窗口的加权均值所代替，未被污染的像素点保持不变。AWMF 中选择加权均值来代替噪声点，而不像AMF 中选择中值，恢复后的图像的效果更为理想，尤其是当噪声水平很高的时候。主要有以下原因。第一，AWMF 算法中加权均值排除了潜在是噪声点的影响，而AMF 中所选取的中值则仍包含潜在噪声点的影响。第二，在相同的条件下，我们做了关于加权中值和加权均值的AWMF 算法对比实验，结果表明，平均来说,噪声点被均值代替后的图像的峰值信噪比(PSNR) 要高于被中值代替后的图像。

本文还做了AMF算法和AWMF算法关于自适应窗口大小的对比实验，见图6，椒盐噪声水平为~ 90\% ，图片为'Lena' \cite{IEEEhowto:imageSource}。 由图~6 中可知，在AWMF 算法中，自适应窗口的半径满足~$w\le 2$~ 条件的像素点超过了~ 90\% ，而AMF 算法中，相同条件下的像素点少于 ~50\%. 除此之外，AWMF 算法中，对图像的所有像素点来说，它们的自适应窗口的最大半径是~5，而AMF 算法中，自适应窗口的最大半径则是~20. 这也就解释了当噪声水平很高的时候，所提出的算法AWMF 要比AMF 算法快的原因。

在"Algorithm 4"~的第~3~步中，标注~$S_{i,j}^{mean}(w)=-1$ ~意味着在 ~$S_{i,j}(w)$~ 窗口中所有的像素点均被检测为噪声点，也就是说此时的 ~$w$~ 并不是一个合适的窗口半径。所以可通过调大窗口半径的上限~$w_{max}$~ 来找到一个有意义的加权均值~$S_{i,j}(w)$。

%  figure 3
\begin{figure}[htp]
\begin{center}
{\includegraphics[width=10cm]{IMG/histogram/windowradium.eps}}
\end{center}
\caption{{\bf{自适应窗口半径直方图(90\%噪声的'Lena' 图像).}}}
\end{figure}

\subsection{实验结果分析}

实验采用六个不同的滤波算法来对被椒盐噪声污染的图像进行恢复，测试用的图像是经典的'Lena','Camera','Gold Hill','Bridge'(\cite{IEEEhowto:imageSource}) 图像,大小是 $512 \times 512 $. 与AWMF 算法相比较的算法是中值滤波法\cite{IEEEhowto:Handbook}(MF)，自适应中值滤波法\cite{IEEEhowto:AMF}(AMF)，noise adaptive fuzzy switching median filter\cite{IEEEhowto:NAFSMF}(NAFSMF), 高效算法（fast and efficient median filter\cite{IEEEhowto:FEMF}(FEMF)） 及文献\cite{IEEEhowto:HighlyCorrupted} 中的算法。
参数设置如下。在中值滤波法(MF)中，阈值~$T=2$, 窗口大小为 ~$w=6$. 在自适应中值滤波法(AMF) 中，初始值~$w = 1$, $h = 1$, $w_{max} = 39$. 在 NAFSMF 算法中, 窗口半径的上限 ~$w_{max} = 3$, 参数 ~$T_{1}=10$, $T_{2}=30$. 在 FEMF 算法中, 窗口半径的上限~$w_{max} = 40$. 在 AWMF 算法中, 初始化 ~$w= 1$, $h = 1$, $w_{max} = 19$. 除了AWMF 算法外，其他相比较的五个算法的参数，有些是直接采用原文作者给出的参数值，有些是参数优化后的值。论文中所有的实验结果都是在 Windows 7 操作系统，Intel Core i5-3470 CPU@3.20GHz 的处理器, 4GB的内存， 用 MATLAB R2012a 完成的。

\begin{figure}[htp]
\begin{center}
\tiny
\subfigure[90\% SPN.(5.61dB)]{\includegraphics[width=4.5cm]{IMG/figure/img1.eps}}
\subfigure[MF.(11.26dB)]{\includegraphics[width=4.5cm]{IMG/figure/img2.eps}}\\
\subfigure[AMF.(20.74dB)]{\includegraphics[width=4.5cm]{IMG/figure/img3.eps}}
\subfigure[NAFSMF.(22.72dB)]{\includegraphics[width=4.5cm]{IMG/figure/img4.eps}}\\
\subfigure[FEMF(21.54dB)]{\includegraphics[width=4.5cm]{IMG/figure/img5.eps}}
\subfigure[ \cite{IEEEhowto:HighlyCorrupted} (24.50dB)]{\includegraphics[width=4.5cm]{IMG/figure/img6.eps}}\\
\subfigure[AWMF(25.04dB)]{\includegraphics[width=4.5cm]{IMG/figure/img7.eps}}
\subfigure[Clean 'Lena']{\includegraphics[width=4.5cm]{IMG/figure/img8.eps}}\\
\end{center}
\caption{\textbf{含90\%噪声的图像'Lena'去噪结果}}\label{fig:fig3}
\end{figure}



\begin{figure}[htp]
\begin{center}
\tiny
\subfigure[90\% SPN.(5.61dB)]{\includegraphics[width=5.5cm]{IMG/bridge90/Noisy.eps}}
\subfigure[MF.(11.27dB)]{\includegraphics[width=5.5cm]{IMG/bridge90/MF.eps}}\\
\subfigure[AMF.(18.05dB)]{\includegraphics[width=5.5cm]{IMG/bridge90/AMF.eps}}
\subfigure[NAFSMF.(19.86dB)]{\includegraphics[width=5.5cm]{IMG/bridge90/NAFSMF.eps}}\\
\subfigure[FEMF(18.91dB)]{\includegraphics[width=5.5cm]{IMG/bridge90/FEMF.eps}}
\subfigure[ \cite{IEEEhowto:HighlyCorrupted} (20.42dB)]{\includegraphics[width=5.5cm]{IMG/bridge90/HighlyCorrupted.eps}}\\
\subfigure[AWMF(20.90dB)]{\includegraphics[width=5.5cm]{IMG/bridge90/AWMF.eps}}
\subfigure[Clean 'Lena']{\includegraphics[width=5.5cm]{IMG/bridge90/clean.eps}}\\
\end{center}
\caption{\textbf{含90\%噪声的图像'Bridge'去噪结果}}\label{fig:fig3}
\end{figure}


\begin{table}[htp]
\small
\renewcommand{\arraystretch}{1.3}
\caption{\textbf{算法的峰值信噪比PSNR结果}}
\label{table_2}
\centering
\begin{tabular}{|p{1.5cm}|p{1.9cm}|p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1.1cm}p{1.2cm}|}
\hline
{Image} & {Filters} & {20\%} &{ 30\%} &{ 40\%} & {50\%} & {60\%} & {70\%} & {80\%} &{ 90\% } &{Average}\\
\hline
\multirow{6}*{Lena}
 &MF   & 24.91 & 24.80  & 24.65 & 24.37 & 23.97 & 23.10 & 20.01 & 11.26   & 22.13\\
 &AMF  & 34.62 & 32.48  & 30.68 & 28.89 & 27.25 & 25.50 & 23.49 & 20.74   & 27.96\\
 &NAFSMF & 34.51 & 32.50  & 31.05 & 29.87 & 28.75 & 27.58 & 26.08 & 22.72   & 29.13\\
 &FEMF   & 31.58 & 30.72  & 29.87 & 28.88 & 29.72 & 28.61 & 27.16 & 21.54  & 28.51\\
 &\cite{IEEEhowto:HighlyCorrupted}& 32.97 & 32.42 & 31.80 & 30.98 & 29.98& 28.76 & 27.21 & 24.50  & 29.83 \\
 &AWMF& \textbf{36.30} & \textbf{35.06}  & \textbf{33.86} & \textbf{32.62} & \textbf{31.17} & \textbf{29.50} & \textbf{27.67} & \textbf{25.04}  & \textbf{31.40}\\
\hline
\multirow{6}*{Camera}
&MF     &20.46   &20.36   &20.21   &20.02   &19.73   &19.18   &17.56   &11.32   & 18.61\\
&AMF    &28.80   &27.07   &25.21   &23.94   &22.60   &21.30  &19.62   &17.53   & 23.26\\
&NAFSMF  &29.13   &27.33   &25.88   &24.81  &23.88  &22.88   &21.73   &19.76   & 24.42\\
&FEMF    &25.89   &25.15  &24.34   &23.61   &24.02   &23.25   &22.26   &18.46   & 23.37\\
&\cite{IEEEhowto:HighlyCorrupted}  & 26.07  & 25.86  & 25.40 & 24.83  & 24.22  & 23.30  & 22.23  & 20.17 & 24.01\\
&AWMF  & \textbf{30.54}  &\textbf{29.07}   &\textbf{27.83}   &\textbf{26.70}   &\textbf{25.56}   &\textbf{24.23}   &\textbf{22.73}   &\textbf{20.73}   & \textbf{25.92}\\
\hline
\multirow{6}*{Gold Hill}
&MF   &22.18    &22.15    &22.05    &21.93    &21.73    &21.36    &19.48   &11.71 & 20.32\\
&AMF    &29.83    &28.36    &27.02    &25.67    &24.39    &23.16    &21.64   &19.72 & 24.97\\
&NAFSMF  &31.35    &29.49   & 28.15  &27.01    &26.08  &25.12    &23.97   &21.74 & 26.61\\
&FEMF    &27.15   &26.60  &25.98    &26.19    &25.64    &25.00    &24.06   &20.98 & 25.20\\
&\cite{IEEEhowto:HighlyCorrupted}  & 27.74  & 27.58   &27.09   &26.54  & 25.90   &25.03 &  24.01 &  21.86& 25.72\\
&AWMF &\textbf{32.47}   &\textbf{30.94}    &\textbf{29.60}    &\textbf{28.34}    &\textbf{27.17}    &\textbf{25.97}    &\textbf{24.57}    &\textbf{22.85}  & \textbf{27.74}\\
\hline
\multirow{6}*{Bridge}
&MF    &20.56    &20.44    &20.27    &20.07    &19.80    &19.35   &17.66    &11.27 & 18.68\\
&AMF   &28.45    &27.00  &25.60    &24.24    &22.93    &21.56   &20.00    &18.05 & 23.48\\
&NAFSMF &29.14    &27.43    &26.14   &25.00    &24.04    &23.10   &21.95    &19.86 & 24.58\\
&FEMF   &25.55    &24.99    &24.38    &24.67   &24.05    &23.31   &22.28    &18.91 & 23.52\\
&\cite{IEEEhowto:HighlyCorrupted}  &26.20  & 25.91   &25.48   &24.92   &24.25  & 23.39   &22.24  & 20.42 & 24.10\\
&AWMF &\textbf{30.47}    &\textbf{29.15}    &\textbf{27.93}    &\textbf{26.69}    &\textbf{25.49}    &\textbf{24.20}   &\textbf{22.74}    &\textbf{20.90} & \textbf{25.95}\\
\hline
\end{tabular}
\end{table}

\begin{figure}[htp]
\begin{center}
\subfigure['Lena'.]{\includegraphics[width=8cm]{IMG/plot_Err/lena.eps}}
\subfigure['Camera']{\includegraphics[width=8cm]{IMG/plot_Err/camera.eps}}\\
\subfigure['Gold Hill']{\includegraphics[width=8cm]{IMG/plot_Err/goldhill.eps}}
\subfigure['Bridge']{\includegraphics[width=8cm]{IMG/plot_Err/bridge.eps}}
\caption{\textbf{对数运算后的检测错误率曲线}}\label{fig:fig1}
\end{center}
\end{figure}

\begin{table}[htp]
\small
\renewcommand{\arraystretch}{1.3}
\caption{\textbf{算法的去噪时间. 单位(秒)}}
\label{table_3}
\centering
\begin{tabular}{|p{1.5cm}|p{1.9cm}|p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1.1cm}p{1.2cm}|}
\hline
{Image} & {Filters} & {20\%} &{ 30\%} &{ 40\%} & {50\%} & {60\%} & {70\%} & {80\%} &{ 90\% } &{Average}\\
\hline
\multirow{6}*{Lena}
 &MF    & 3.5880 & 3.5724 & 3.4788 & 3.4632 & 3.4008 & 3.3696 & 3.2760 & 3.1512  & 3.4125\\
 &AMF      & 6.0684 & 5.8344 & 5.9748 & 6.3492 & 7.1292 & 8.2837 & 10.7485 & 17.7217  & 8.5138\\
 &NAFSMF    & 2.6520 & 3.8220 & 5.0700 & 6.2556 & 7.3944 & 8.6893 & 9.8125 & 10.7797  & 6.8094\\
 &FEMF      & 4.6020 & 4.4928 & 4.5240 & 4.5864 & 4.7268 & 4.7424 & 4.7268 & 6.2712  & 4.8341\\
 &\cite{IEEEhowto:HighlyCorrupted} & 11.4973 & 12.0433 & 12.2461 & 12.0745 & 11.4037 & 11.3257 & 11.2321 & 11.1229 & 11.6182\\
 &AWMF  & 7.5036 & 6.6612 & 6.4428 & 6.4428 & 6.4584 & 6.6300 & 6.8016 & 7.5192  & 6.8075\\
\hline
\multirow{6}*{Camera}
 &MF    & 0.9516 & 0.9048 & 0.8892 & 0.8736 & 0.8736 & 0.8424 & 0.8268 & 0.7956  & 0.8697\\   %\cite{IEEEhowto:Handbook}
 &AMF     & 1.8720 & 1.4976 & 1.4976 & 1.6224 & 1.7472 & 2.0592 & 2.6832 & 4.5396  & 2.1899\\   %\cite{IEEEhowto:AWMF}
 &NAFSMF   & 0.7332 & 0.98281 & 1.3104 & 1.5912 & 1.9032 & 2.184 & 2.4492 & 2.7768  & 1.7414\\   %\cite{IEEEhowto:NAFSMF}
 &FEMF      & 1.1544 & 1.1076 & 1.092 & 1.1076 & 1.1700 & 1.1700 & 1.2168 & 1.6068
 & 1.2032\\   %\cite{IEEEhowto:FEMF}
 &\cite{IEEEhowto:HighlyCorrupted} & 2.886 & 2.9484 & 3.0576 & 2.9796 & 2.9952 & 2.9484 & 2.9328 & 2.9172  & 2.9582\\
 &AWMF   & 1.9812 & 1.7160 & 1.6536 & 1.5912 & 1.5912 & 1.6380 & 1.6380 & 1.8876  & 1.7121\\
\hline
\multirow{6}*{Gold Hill}
 &MF         & 0.9204 & 0.9048 & 0.8892 & 0.8892 & 0.8892 & 0.8268 & 0.8112 & 0.7956  & 0.8658\\
 &AMF        & 1.4352 & 1.4508 & 1.5600 & 1.5756 & 1.7628 & 2.0748 & 2.6832 & 4.3680  & 2.1138\\
 &NAFSMF     & 0.6552 & 0.9672 & 1.2636 & 1.5600 & 1.8252 & 2.1372 & 2.4024 & 2.6832  & 1.6868\\ %\cite{IEEEhowto:NAFSMF}
 &FEMF       & 1.1232 & 1.1544 & 1.1076 & 1.1700 & 1.1700 & 1.1544 & 1.1544 & 1.5756  & 1.2012\\  %\cite{IEEEhowto:FEMF}
 &\cite{IEEEhowto:HighlyCorrupted}  & 2.9328 & 2.9484 & 3.0420 & 3.0108 & 2.9796 & 2.9796 & 2.9796 & 2.9640  & 2.9796\\  %
 &AWMF       & 1.8408 & 1.7004 & 1.7160 & 1.6068 & 1.6380 & 1.5756 & 1.6224 & 1.8408  & 1.6926\\
\hline
\multirow{6}*{Bridge}
 &MF          & 3.7284 & 3.6036 & 3.6036 & 3.4632 & 3.4320 & 3.3540 & 3.2604 & 3.2916  & 3.4671\\
 &AMF         & 5.9436 & 6.0528 & 6.2244 & 6.5832 & 7.2696 & 8.5333 & 10.9513 & 17.9869  & 8.6932\\
 &NAFSMF  & 2.6832 & 3.8220 & 5.0700 & 6.2088 & 7.3788 & 8.5333 & 9.6721 & 10.9981  & 6.7958\\
 &FEMF      & 4.4772 & 4.4304 & 4.3992 & 4.5864 & 4.5708 & 4.6332 & 4.6800 & 6.3960  & 4.7717\\
 &\cite{IEEEhowto:HighlyCorrupted}  & 11.1073 & 11.3881 & 11.4037 & 11.6065 & 11.5441 & 11.3569 & 11.3257 & 11.2945  & 11.3783\\
 &AWMF  & 7.4568 & 6.7860 & 6.5052 & 6.3336 & 6.2868 & 6.3024 & 6.5676 & 7.3788  & 6.7022\\
\hline
\end{tabular}
\end{table}

论文分别从恢复后图像的峰值信噪比(PSNR)、检测错误率(Error Rate)、 耗费时间上三个方面来评价ACWM 算法。图 7 和图8 分别 给出了对含有90\% 椒盐噪声的'Lena' 和'Bridge'图像运用滤波算法恢复后的结果。图7.(b) 中MF 算法去噪后的图像中还存在很多未被检测到和未恢复的噪声点。从被AMF 算法恢复的图7.(c) 可知，图像的边缘部分变得模糊，细节也处理地很模糊。图7.(d) NAFSMF 算法去噪后，图像中依然存在一些零星的噪声点。图7.(e), 图7.(g), 和图7.(h) 的图像去噪效果要较好些，但图7.(e) 中很多细节部分仍然很模糊，所以PSNR 只有21.50。7.(g), 和图7.(h) 看起来没有差别，但经AWMF 算法去噪后的图7.(h) 的PSNR 比\cite{IEEEhowto:HighlyCorrupted} 中算法去噪后的图7.(g) 高出0.54dB。 因此，所提出的算法AWMF 在边缘保护和滤波方面是有效的。

表1 显示了对于不同的图像在不同的噪声水平下，应用算法去噪后的图像的PSNR 值。表中可以看出，算法MF 的PSNR 值是最低的。对于图像'Lena' 来说，只有当噪声水平低于 50\% 时，算法AMF 去噪后图像的PSNR 值才比算法FEMF 高些；类似的情况还有算法NAFSMF 和\cite{IEEEhowto:HighlyCorrupted} 中算法。算法AWMF 的PSNR 的平均值为 31.4018dB，\cite{IEEEhowto:HighlyCorrupted}中算法的PSNR 为 29.8285dB。 由表1 可知，我们所提出的算法 AWMF 的去噪效果要好于其他的滤波法，并且尤其当椒盐噪声水平很高时，效果越显著。

图9 表示算法在不同噪声水平下的检测错误率曲线（此处错误率是被常用对数作用后的值）。这里的检测错误是指一个原来的噪声点被检测为未被噪声污染，或者是相反的情况。从图9.(a)-(d) 可知，算法FEMF 和\cite{IEEEhowto:HighlyCorrupted}的错误率都很高，且两者基本持平。这两种算法都是根据自然图像的先验信息，依靠自觉把灰度值的最大值或最小值判断为噪声点。只有算法NAFSMF 的错误率曲线呈现逐渐上升趋势。算法AWMF 的错误率是所有算法中最小的。而图 9(b)-(c) 中在噪声水平达到某个值后，曲线消失的原因是，算法的错误率值为0，被自然对数作用后变为负无穷。也就是说，如果参数值合适的情况下，算法AWMF 和AMF 可以检测出所有的噪声点。因此，在检测精度方面，算法AWMF 优于其他的算法。

表2 表明算法在不同的图像及不同的噪声水平下的计算时间。显然，算法MF 的平均计算时间是最短的，而\cite{IEEEhowto:HighlyCorrupted} 中算法是最长的。本文所提出的算法AWMF 位列中间，但优于算法AMF。 算法AMF 和NAFSMF 的计算时间随着噪声水平的递增而递增。而其他的算法包括AWMF 的计算时间在不同的噪声水平下，基本保持稳定。


%
%\section{基于字典学习理论下的椒盐噪声去噪模型}
%
%
%
%\subsection{图像椒盐噪声模型}
%


%\section{椒盐-高斯混合噪声去噪方法}
%
%虽然椒盐噪声模型便于分析和处理，但现实中往往不只含有一种噪声，比如椒盐噪声和高斯噪声的混合噪声亦常常出现。
%%对于一幅被椒盐噪声和高斯噪声污染的图像$y$来说，本文先采用自适应加权均值滤波算法对噪声图像$y$ 进行处理，得到图像$x_{1}$, 然后
%%针对图像$x_{1}$再次进行处理。
%
%一个干净的图片$u$ 被椒盐噪声和零均值的高斯均匀加性白噪声污染，混合噪声记为 $v$，标准差是$\sigma$，噪声图像记为$y$。 经第一阶段自适应加权均值滤波算法处理后的图像记为$x$，经第二阶段采用稀疏表示理论处理后的所得图像为 $z$。 第一阶段自适应加权均值滤波算法，前面已经介绍过。接下来，我们目的是要从图像$x$ 中去除噪声，且尽可能接近原来的图像$u$。
%
%图像去噪问题很重要，不仅因为它自身明显的应用，而且对于最简单的求逆问题，它提供了一个方便的平台，借此图像处理思想和技术可以被运用。事实上，过去50 年来大量的文献研究从各种不同的角度处理这类问题。在这个问题的研究中，研究者探索了很多方向的研究，诸如各种类型的数据估计，空间自适应滤波器，随机分析，偏微分方程，阈值转换方法，样条函数和其他近似理论方法，形态学分析，顺序量统计等等。在这篇文章中，我们不一一介绍这些具体的方法。相反，我们打算详尽地介绍可以高效处理此问题的一个特定方法――――基于字典学习理论下的稀疏和冗余表示方法。
%
%本文将详细阐述稀疏表示的基础理论，建立相应的去噪模型，并对实验结果进行分析。
%
%\subsection{稀疏表示理论（待修改）}
%
%
%
%总之，本文采用表示图像局部稀疏性和冗余性的方式―― 全局贝叶斯对象，这部分内容将和算法的合并迭代数值解一起介绍。k-svd 算法的亮点是训练字典的思想，而不是用一个已选的字典来进行图像去噪。正如前面所提到的，当在被污染的图像上直接训练结束时，全局的训练去噪算法开始和一个迭代过程结合起来，构成了图像去噪模块的步骤。这一部分内容将在下午详细介绍。最后，我们将显示我们的实验结果以说明算法的有效性。
%
%
%这一部分中，我们要介绍稀疏性和冗余性表示理论和K-SVD去噪算法。首先，需要建立Sparseland 模型。一旦这个模型确定，我们将可以讨论，局部处理图像块的方法如何通过贝叶斯重建的过程，转换成一个全局优先的方法。
%
%\subsubsection{由局部到全局的贝叶斯重建---图像块的Sparseland模型}
%
%给定$\sqrt{n}\times\sqrt{n}$个像素的图像块$x$，图像块按矩阵的列向量顺序依次排列成一个向量。在Sparseland 模型的构建过程，我们需要定义一个字典矩阵$D\in R^{n\times k}$ （$k>n$, 说明矩阵是冗余的）。现在假定这个矩阵已经是给定的。由相关的数学理论我们可以知道，提出的Spareland 模型中，每一个图像块$x$, 都可以用这个字典矩阵稀疏表示。也就是说，方程
%
%\begin{equation}\label{3}
%   \hat{a} = arg \min\limits_{a}  ||a||_{0}  \\
%   s.t.   Da \approx x
%\end{equation}
%的解确实是稀疏的，即 $||a||_{0}\ll n$, 其中$||a||_{0}$表示$a$中非零元的个数。这个模型的基本思想是，每一个图像块都可以用一个冗余的字典矩阵里的列向量来线性表示。
%
%这个模型还可以用一个确定的限制阈值――允许边界误差$||Da-x||_{2} \leq \epsilon$，来更清晰地代替粗略的限制条件$Da\approx x$。 并且，可以通过添加一个条件――――$||\hat{a}||_{0}\leq L \ll n$， 来定义所要求的稀疏性的程度。这个条件表明，图像块$x$ 可以只用字典中不超过$L$ 个列向量来进行稀疏性表示。此外，还可以给出一种概率意义的描述，在某种意义上，定义用$|| \hat{a} ||_{0}$ 个非零元得到的稀疏性表达式作为一种衰退函数。在三维空间$(\epsilon,L,D)$ 中，模型是 良好定义的。
%
%现在假定$x$是属于Sparseland模型的向量空间$(\epsilon,L,D)$ 中的一个元素。给定一个被高斯零均值加性白噪声，标准差为$\sigma$ 污染的图像$y$. 运用概率论中最大后验估计（MAP）的方法，则去除图像块噪声的模型是
%
%\begin{equation}\label{3}
%   \hat{a} = arg \min\limits_{a} ||a||_{0} s.t.
%      ||Da-y||_{2}^{2}\leq T
%\end{equation}
%$T$由$\epsilon,\sigma$决定。去噪后的图像由公式
%$\hat{x}=D \hat{a}$\cite{IEEEhowto:Atomic},\cite{IEEEhowto:Stable},\cite{IEEEhowto:Just}
%给出。注意到上面的公式可以变为
%\begin{equation}\label{4}
%   \hat{a} = arg \min\limits_{a} ||Da-y||_{2}^{2} + \mu ||a||_{0}  \\
%\end{equation}
%所以，限制条件变成了一个惩罚函数。选取一个合适的$\mu$值，以上两个问题是相等的。从现在起，我们运用这个替代的模型，因为它可以使得后面的表达变得更简单些。
%
%一般来说，这个问题是很难解的，不过，匹配追逐算法可以很好地得到一个近似解。近来的研究工作表明，如果初始值足够稀疏地话，解会变得很精确。因其算法的简单些和高效性，求解的过程中将主要运用正交匹配追踪算法OMP 完成。
%
%\subsubsection{由局部到全局的贝叶斯重建---从局部分析到全局最优}
%
%如果要处理一个更大的图像$X$, 大小为$\sqrt{N}\times|sqrt{N}(N\ll n)$，仍然运用上面的模型，不过要重新定义一个更大的字典矩阵。事实上，当用从曲线波变换得出的字典来运用这个模型时，维数就变得简单了。
%
%然而，我们仍然可以用一个特定的小字典 $D\in R^{n\times k}$ 来进行求解。原因有二：1）当训练发生时，只有小字典可以完成；2）小字典可以解决局部的问题，包含了解决整体问题的思想。
%
%接下来要介绍用这样一个小字典来处理一个大的图像的方法，即，先尝试在小的图像块上逐个处理，然后整理所有的结果。这样做的话，会在修复图像的边缘出现可视化的人工修理痕迹。为此，也有人提出在重叠的块上处理然后取平均值来消除此问题。接下来我们将看到，一个对称的整体的解决此问题的方法，将作为处理整个问题的核心思想出现。
%
%如果大图像$X$是高度压缩的，并且每一个小的图像块都属于$(\epsilon,L,D)$-Sparseland 模型，然后上述最大后验估计自然地替代为以下公式
%
%\begin{equation}\label{4}
%   {\hat{a_{i,j}},\hat{X}} = arg \min\limits_{a_{i,j},X} \lambda||X-Y||_{2}^{2}
%   +\sum\limits_{i,j}  \mu|{i,j} ||a_{i,j}||_{0}+\sum\limits_{i,j} ||Da_{i,j}-R_{i,j}X||_{2}^{2}
%\end{equation}
%
%上述公式中，第一项是整体极大似然函数，要求被污染的图像$Y$ 和去噪后的图像$X$
%要接近。作为限制条件，这个惩罚函数将会产生
%
%$||X-Y||_{2}^{2}\leq Const \times \sigma^{2}$
%其反映出$\lambda$ 和$\mu$ 的关系。
%
%第二项和第三项的目的是要优先确保得到的图像$X$ 中，每个位置的大小为$\sqrt{n}\times \sqrt{n}$ 的图像块满足$X_{i,j}=R_{i,j}X$，且在界限误差内可以稀疏表示。当Roth 和 Black 处理MRF 先验时也有类似的表达。
%
%矩阵$R_{i,j}$表示选取图像的第$(i,j)$个$n\times N$ 矩阵的矩阵。对$\sqrt{N}\times \sqrt{N}$ 的图像$X$ 来说，如何考虑图像块可以重叠的话，对$i,j$ 求和会得到$(\sqrt{N}-\sqrt{n}+1)^{2}$ 项。而系数$\mu_{i,j}$ 是局部不独立的，因为受限于条件$||Da_{i,j}-x_{i,j}||_{2}^{2}\leq T$.
%
%\subsubsection{由局部到全局的贝叶斯重建---数值解}
%
%当字典$D$假定为已知时，公式（4.4）中提出的惩罚函数有两个未知量：稀疏系数$\hat{a_{i,j}}$ 和整体输出图像$X$。 我们提出一个与块相协调的最小值算法，赋初始值$X=Y$. 然后寻找最优的$\hat{a_{i,j}}$. 如此一来，对于许多更小的来说，可以得到最小值任务完整的去耦合。每一个形式为
%
%\begin{equation}\label{4}
%   \hat{a_{i,j}} = arg \min\limits_{a}  \mu|{i,j} ||a||_{0}+ ||Da-X_{i,j}||_{2}^{2}
%\end{equation}
%用正交匹配追踪来解决此问题是很容易的，一次得到一个列向量，当条件不满足时停止。这样一来，$\mu_{i,j}$ 可以暗含地解决。因此，这一步需要平移窗口，一次在一个块上操作。
%
%给定所有的$\hat{a_{i,j}}$,我们固定其他变量，更新$X$。回到(4.4) 式，我们需要解决
%\begin{equation}\label{4}
%   {\hat{X}} = arg \min\limits_{X} \lambda||X-Y||_{2}^{2}
%   +\sum\limits_{i,j} ||Da_{i,j}-R_{i,j}X||_{2}^{2}
%\end{equation}
%这是一个简单的二次方程问题，有闭形式的解
%\begin{equation}\label{4}
%   {\hat{X}} = (\lambda I+\sum\limits_{i,j}R_{i,j}^{T}R_{i,j})^{-1}(\lambda Y+\sum\limits_{i,j}R_{i,j}^{T}D\hat{a}_{i,j})
%\end{equation}
%
%这个表达式可能会产生误导，因为它表明去噪后的图像块的平均过程要被完成。上式中的逆矩阵是对角矩阵，因此，公式(4.7) 的计算可以在像素点的基础上完成。
%
%目前为止，我们已经看到去噪算法需要小块的稀疏表示，和一个平均结果的过程。然而，如果公式(4.4) 的最小值是我们的求解目标，那么这个过程应该继续下去。给定更新后的$X$，我们可以在已经恢复过的图像上重复稀疏表示过程。一旦完成，一个新的平均结果会被计算出来。因此，我们精确地得到了
%Guleryuz在文献中所完成的工作――通过稀疏表示迭代去噪。我们把这里提出的分析称为严格的矫正迭代主题的方式。
%
%
%\subsection{基于实例的稀疏和冗余性}
%目前我们所有的讨论都是基于字典$D\in R^{n\times k}$ 已知的基础上的。我们也当然可以关于选取哪一个字典提出一些猜想。事实上，在Guleryuz 的工作中，DCT 字典看起来可以一试。像文献[36] 提出的那样，我们可以用DCT 字典的冗余矩阵类型做得更好。尽管如此，问题是：我们可以通过训练得到一个更好的字典$D$a 吗？现在我们讨论这个问题。在一个较高质量的图像的所有块的集合上训练字典，初始值可以是较简单的，然后接下来讨论在被污染的图像上训练字典的过程。
%
%\subsubsection{在有噪声的图像块上训练字典}
%给定一个图像块集合$Z={Z_{j}}^{M}_{j=1}$,大小均为$\sqrt{n}\times \sqrt{n}$, 并且假定其满足$(\epsilon,L,D)$-Sparseland 模型，我们需要估计模型参数$(\epsilon,L,D)$。正式地说，我们试图寻找最小化方程
%\begin{equation}\label{4}
%   \epsilon(D,{a_{j}}^{M}_{j=1})=\sum\limits_{j=1}^{M}[\mu_{j}||a_{j}||_{0}+||Da_{j}-z_{j}||_{2}^{2}]
%\end{equation}
%的字典$D$.以上表达式试图对于每一个例子$Z$得到一个稀疏表示,并得到一个小的误差。为了是其中一个有更清晰的限制，对$\mu_{i,j}$ 的选取表明那两项是如何权衡的。例如，限制$\forall||a_{j}||_{0}=L$ 暗含特定的值$\mu_{j}$, 然而限制条件$\forall ||Da_{j}-z_{j}||_{2}^{2} \leq \epsilon ^{2}$ 则无法满足。
%
%\begin{algorithm}
%任务:对一个被标准差为$\sigma$的高斯加性白噪声污染的图像去噪。
%算法参数：$n$-图像块大小，$k$-字典大小，$J$-迭代次数， $\lambda$- 拉格朗日乘数，$C$- 噪声水平。
%\begin{equation}\label{0}
%  \min\limits_{X,D,A}{\lambda ||X-Y||+\sum\limits_{i,j}\mu_{i,j}||a_{i,j}||_{0}+\sum\limits_{i,j}||Da_{i,j}-R_{i,j}X||_{2}^{2}}
%\end{equation}
%
%\begin{enumerate}
%\item
%初始化：设置 $X=Y，D=$冗余的DCT字典.
%\item
% 重复$J$次：\\
% 稀疏表示过程：在每一个图像块$R_{i,j}X$上，用匹配算法求得稀疏向量$a_{i,j}$, 通过近似求解
% \begin{equation}\label{2}
%   \forall \min\limits_{a_{i,j}} ||a_{i,j}||_{0}  s.t.  ||Da_{i,j}-R_{i,j}X||_{2}^{2}\leq (C\sigma)^{2}
% \end{equation}  \\
%字典更新过程：对$D$中每一列$l=1,2,...,k$，通过以下更新: \\
%   (1)用$w_{l}= {(i,j) a_{i,j}(l)\neq 0}$来找到图像块的集合；\\
%
%   (2)对每一个$(i,j)\in w_{l}$,计算误差
%   $e_{i,j}^{l}=R_{i,j}X_{i,j}-\sum\limits_{m \neq l}d_{m}a_{i,j}(m)$;\\
%   (3)构造矩阵$E_{l}$,它的列向量为${e^{l}_{ij}}_{(ij)\in w_{l}}$;
%   (4)由SVD分解得$E_{l}= U \Delta V_{T}$.选择更新后的字典的列向量$\hat{d}_{l}$ 作为$U$ 的第一列，更新系数${\alpha_{ij}^{l}}_{(ij)\in w_{l}}$ 作为$V$ 乘以$\Delta(1,1)$ 后的入口。
%\item
%设置：\\
%$X=(\lambda I+\sum\limits_{i,j}R_{ij}^{T}R_{ij})^{-1}(\lambda Y+\sum\limits_{i,j}R_{ij}^{T}D\alpha_{ij})$
%
%\end{enumerate}
%\caption{稀疏表示算法}
%\end{algorithm}
%
%
%
%\subsection{实验与结果分析}
%
%实验采用自适应加权均值滤波算法和稀疏表示理论对被椒盐噪声和高斯噪声污染的图像进行恢复。去噪过程共分为两个阶段，第一个阶段是运用自适应加权均值滤波算法来对椒盐噪声进行处理；第二个阶段是运用稀疏表示理论来对高斯噪声进行降噪，其中训练字典的方法分别采用了DCT 生成字典和自适应图像训练字典
%\cite{IEEEhowto:KSVD},\cite{IEEEhowto:Improved} 两种方式。
%
%实验测试用的图像是大小为 $512 \times 512 $经典'Lena','Barbara','boat','bridge'(\cite{IEEEhowto:imageSource}) 图像和大小为$256 \times 256 $ 的'peppers256','house'图像。
%运用自适应加权均值滤波方法对图像进行第一阶段滤波处理时的参数设置不变，即初始化 $w= 1$, $h = 1$, $w_{max} = 19$. 运用稀疏表示理论时，参数设置如下：$\lambda=10,\sigma=15，\quad \epsilon =1.15, T=\epsilon \sigma$\cite{IEEEhowto:KSVD}。
%
%论文采用DCT生成字典和自适应图像训练字典两种方法来对图像中的高斯噪声进行恢复处理。图10 和图11 分别给出了椒盐噪声水平为70\% 和零均值高斯噪声的标准差为$\sigma=15$时的图像'Lena' 和'Barbara'的恢复效果。从图10.(c)和图11.(c) 可以看出，运用DCT 生成字典的方法对图像进行处理后，图像的边缘部分保留得较好，但是图像整体仍然包含有噪声。而图10.(d) 和图11.(d) 则可以看出，图像的边缘虽然有些轻微的模糊，但整体来说未见到明显的噪声点。
%
%
%图12表示两种算法在不同椒盐噪声水平下的PSNR曲线（此处PSNR 是被常用对数作用后的值）。从图12.(a)-(e) 可知，第二阶段运用图像自适应训练字典（Adaptive Dictionary）方法得到的PSNR 要高于DCT 字典的值，并且这种差距随着椒盐噪声水平的提高而逐步缩小。
%
%
%算法FEMF 和\cite{IEEEhowto:HighlyCorrupted} 的错误率都很高，且两者基本持平。这两种算法都是根据自然图像的先验信息，依靠自觉把灰度值的最大值或最小值判断为噪声点。只有算法NAFSMF 的错误率曲线呈现逐渐上升趋势。算法AWMF 的错误率是所有算法中最小的。而图 9(b)-(c) 中在噪声水平达到某个值后，曲线消失的原因是，算法的错误率值为0，被自然对数作用后变为负无穷。也就是说，如果参数值合适的情况下，算法AWMF 和AMF 可以检测出所有的噪声点。因此，在检测精度方面，算法AWMF 优于其他的算法。
%
%表2 表明算法在不同的图像及不同的噪声水平下的计算时间。显然，算法MF 的平均计算时间是最短的，而
%\cite{IEEEhowto:HighlyCorrupted} 中算法是最长的。本文所提出的算法AWMF 位列中间，但优于算法AMF。 算法AMF 和NAFSMF 的计算时间随着噪声水平的递增而递增。而其他的算法包括AWMF 的计算时间在不同的噪声水平下，基本保持稳定。
%
%
%\begin{figure}[htp]
%\begin{center}
%\subfigure[噪声图像 SPN:70\%,$\sigma=15$ (6.9815dB).]{\includegraphics[width=8cm]{IMG/lena/noisy70.eps}}
%\subfigure[原始‘Lena’]{\includegraphics[width=8cm]{IMG/lena/clean.eps}}\\
%\subfigure[DCT字典(24.8789dB)]{\includegraphics[width=8cm]{IMG/lena/DCT248789.eps}}
%\subfigure[图像自适应字典(25.8079)]{\includegraphics[width=8cm]{IMG/lena/Adaptive258079.eps}}
%\caption{\textbf{图像‘Lena’去噪效果图}}\label{fig:fig1}
%\end{center}
%\end{figure}
%
%
%\begin{figure}[htp]
%\begin{center}
%\subfigure[噪声图像 SPN:70\%,$\sigma=15$ (6.7922dB).]{\includegraphics[width=8cm]{IMG/barbara/noisy70.eps}}
%\subfigure[原始‘Barbara’]{\includegraphics[width=8cm]{IMG/barbara/clean.eps}}\\
%\subfigure[DCT字典(21.7722dB)]{\includegraphics[width=8cm]{IMG/barbara/DCT21-7722.eps}}
%\subfigure[图像自适应字典(22.3566)]{\includegraphics[width=8cm]{IMG/barbara/Adaptive22-3566.eps}}
%\caption{\textbf{图像‘Barbara’去噪效果图}}\label{fig:fig1}
%\end{center}
%\end{figure}
%
%\begin{figure}[htp]
%\begin{center}
%\subfigure['Lena'.]{\includegraphics[width=8cm]{IMG/plot_Psnr/lena.eps}}
%\subfigure['Barbara']{\includegraphics[width=8cm]{IMG/plot_Psnr/barbara.eps}}\\
%\subfigure['House']{\includegraphics[width=8cm]{IMG/plot_Psnr/house.eps}}
%\subfigure['pepper']{\includegraphics[width=8cm]{IMG/plot_Psnr/pepper.eps}}\\
%\subfigure['Boat']{\includegraphics[width=8cm]{IMG/plot_Psnr/boat.eps}}
%\caption{\textbf{对数运算后的峰值信噪比（PSNR）曲线}}\label{fig:fig1}
%\end{center}
%\end{figure}

\newpage
\section{总结与展望}

\subsection{本文工作总结}

椒盐噪声对图像的破坏主要表现为：图像噪声点处的亮度与邻域里其他像素点的亮度值具有明显的差异和区别。这种区别在图像上表现为黑白亮暗点，造成了图像质量严重下降。即使是少量的椒盐噪声也会极大地降低图像的整体效果，进而影响图像复原、分割、特征提取、图像识别等等后续工作的进行。
可见，椒盐噪声对图像的破坏是极其严重的。因此，对椒盐噪声的滤除是图像处理中一项非常重要的工作。

%在图像处理过程中，图像表示是一个非常复杂又及其重要的过程，图像表示的目的是希望获得一简单的表达式，以降低图像处理过程中的复杂度。
%图像的稀疏表示主要沿着两条主线展开，即多尺度分析理论和过完备字典分解。前者任务图像具有非平稳性和非高斯性，线性理论时很难处理的，只能通过建立适合吹边缘及纹理各层面几何结构的图像表示模型。

%本文主要研究被椒盐噪声污染的图像和被椒盐噪声与高斯噪声混合噪声污染后的图像的去噪的方法。

本文主要研究当图像被椒盐噪声污染后，尤其是噪声水平很高的时候，图像的滤除噪声的方法。
在阅读了多本经典的数字图像处理的相关教材，研读了大量的文献后，本文基于经典的自适应中值滤波算法（AMF）的基础上，提出了一种新的滤波算法―――― 自适应加权均值滤波算法（AWMF），并利用经典的图像进行实验比较，结果表明，所提出的算法的滤波效果好于很多其他的算法，尤其是自适应中值滤波算法。并且，尤其是噪声水平越高，所提算法的优越性也就越显著。
%并借助于近几年来迅速发展的基于稀疏表示和字典学习的理论，对噪声图像进行恢复研究。
下面将对全文做出总结，并结合实际应用情况，对今后的研究方向和内容提出一些看法。

1.本文首先介绍了图像去噪的研究背景及意义，图像噪声的分类，各种不同类型的噪声模型。然后又介绍了图像质量的评价方法，以及说明检测错误率的概念。

2.本文主要研究被椒盐噪声污染的图像的滤波算法，总结回顾了传统的经典的滤波算法，如中值滤波算法，自适应模糊开关中值滤波算法，快速高效滤波算法和自适应中值滤波算法等，并指出了算法的缺陷与不足。

3.在经典的自适应中值滤波算法的基础上，本文提出了新的滤波算法――――自适应加权均值滤波算法，弥补了自适应中值滤波算法的不足。通过多幅图的对比实验发现，运用所提出的算法去噪后，不仅图像质量好，峰值信噪比高，而且还具有检测错误率低，耗费时间少的特点。因此，所提出的算法优于现存诸多其他算法。

%3.对于被椒盐噪声和斯噪声污染的图像的去噪问题。本文采取两个阶段的处理方式。首先是
%第一阶段运用提出的算法――――自适应加权均值滤波算法进行去噪，第二阶段运用字典学习和稀疏表示理论来对图像进行处理。字典的获取一般有两种方式：解析和训练学习。本文所采用DCT 字典是解析获取的方法，而根据图像自适应训练学习得到的字典属于后者。
%运用稀疏表示理论对被混合噪声污染的图像进行进一步地处理分析。实验结果表明，去噪后的图像质量较好，错误率较低。

%对于被椒盐噪声污染后的图像，本文在经典算法――自适应中值滤波法的基础上，提出了新的效果更好的算法―― 自适应加权均值滤波算法。对于被两种噪声污染的图像，本文尝试采用将自适应加权均值滤波算法和字典学习理论结合的方法进行去噪。

\subsection{工作展望}

进入21世纪以来，随着计算机技术的迅速发展和科技水平的日益提高，数字图像处理的应用变得越来越重要，要求也越来越高。通过对本文的研究，我对图像处理尤其是图像滤波的基本步骤与主要算法有了一定的了解，也为后续的研究奠定了扎实的理论基础，同时也深深地感觉到对所研究内容不够精通，涉及的研究范围还不够广泛。

本文由于时间所限，研究的工作内容在深度和广度上均有限。由于条件所限，工作中只是采用MATLAB 软件进行了实验，一方面对于噪声环境，仅仅是给出了单一的椒盐噪声进行考虑，没有考虑现实中的多种类型的混合噪声。另一方面，所提出的自适应加权均值滤波算法，具体到实际应用中的实际处理能力还需要进行深入的优化。
所以改进自适应加权均值滤波算法，以及推广至其他类型的噪声如随机值脉冲噪声等都是进一步需要研究的工作。


\newpage


\newpage
\renewcommand{\refname}{\hei 参考文献}

\begin{thebibliography}{1}

\bibitem{IEEEhowto:Handbook}
Bovik A C. \emph{Handbook of image and video processing}.\hskip 1em plus
  0.5em minus 0.4em\relax  Academic Press, 2000.

\bibitem{IEEEhowto:Progressive}
Wang Z, Zhang D. \emph{Progressive switching median filter for the removal of impulse noise from highly corrupted images}.\hskip 1em plus
  0.5em minus 0.4em\relax Circuits and Systems II: Analog and Digital Signal Processing, IEEE Transactions on, 1999, 46(1): 78-80.


\bibitem{IEEEhowto:multi-state}
Chen T, Wu H R. \emph{Space variant median filters for the restoration of impulse noise corrupted images}.\hskip 1em plus
  0.5em minus 0.4em\relax Circuits and Systems II: Analog and Digital Signal Processing, IEEE Transactions on, 2001, 48(8): 784-789.

\bibitem{IEEEhowto:Improved}
Zhang S, Karim M A. \emph{A new impulse detector for switching median filters}.\hskip 1em plus
  0.5em minus 0.4em\relax Signal Processing Letters, IEEE, 2002, 9(11): 360-363.

\bibitem{IEEEhowto:soft-switching}
Eng H L, Ma K K. \emph{Noise adaptive soft-switching median filter}.\hskip 1em plus
  0.5em minus 0.4em\relax Image Processing, IEEE Transactions on, 2001, 10(2): 242-251.

\bibitem{IEEEhowto:AMF}
Hwang H, Haddad R A. \emph{Adaptive median filters: new algorithms and results}.\hskip 1em plus
  0.5em minus 0.4em\relax Image Processing, IEEE Transactions on, 1995, 4(4): 499-502.

\bibitem{IEEEhowto:FEMF}
Hsieh M H, Cheng F C, Shie M C, Ruan S J. \emph{Fast and efficient median filter for removing 1-99\% levels of salt-and-pepper noise in images}.\hskip 1em plus
  0.5em minus 0.4em\relax Engineering Applications of Artificial Intelligence, 2012.

\bibitem{IEEEhowto:NAFSMF}
Toh K K V, Isa N A M. \emph{Noise adaptive fuzzy switching median filter for salt-and-pepper noise reduction}.\hskip 1em plus
  0.5em minus 0.4em\relax Signal Processing Letters, IEEE, 2010, 17(3): 281-284.

\bibitem{IEEEhowto:HighlyCorrupted}
Jourabloo A, Feghahati A H, Jamzad M. \emph{New algorithms for recovering highly corrupted images with impulse noise}.\hskip 1em plus
  0.5em minus 0.4em\relax Scientia Iranica, 2012.

\bibitem{IEEEhowto:Convex}
J.A>Tropp, \emph{Just relax:Convex programming methods for subset selection and sparse approximation}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans. Inf. Theory,vol.51,no.3,pp.1030-1051,Mar.2005.

\bibitem{IEEEhowto:Stable}
D.L.Donoho,M.Elad and V.Temlyakov \emph{Stable recovery of sparse overcomplete representations in the presence of noise}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans.Inf.Theory,vol52,no.1, pp.6-18,Jan.2006.

\bibitem{IEEEhowto:weighted overcom}
 O.G.Guleryuz \emph{Weighted overcomplete denoising}.\hskip 1em plus
  0.5em minus 0.4em\relax presented at the Asilomar Conf.Signals and Systems,Pacific Grove,CA,Nov.2003.

\bibitem{IEEEhowto:restoring}
 B.R.Frieden \emph{Restoring with maximum likelihood and maximum entropy}.\hskip 1em plus
  0.5em minus 0.4em\relax J.Opt. Soc. Am.62(1972)511.

\bibitem{IEEEhowto:SaltPepperNoise}
Chan R H, Ho C W, Nikolova M. \emph{Salt-and-pepper noise removal by median-type noise detectors and detail-preserving regularization}.\hskip 1em plus
  0.5em minus 0.4em\relax Image Processing, IEEE Transactions on, 2005, 14(10): 1479-1485.

\bibitem{IEEEhowto:Fast}
 T.S.~Huang,G.J.~Yang,and G.Y~Tang. \emph{Fast two-dimensional median filtering algorithm}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Transactions on Acoustics,Speech, and Signal Processing,1(1979),pp.13-18.

\bibitem{IEEEhowto:noiseDetection}
Luo W. \emph{Efficient removal of impulse noise from digital images}.\hskip 1em plus
  0.5em minus 0.4em\relax Consumer Electronics, IEEE Transactions on, 2006, 52(2): 523-527.

\bibitem{IEEEhowto:OMP}
S.Roth and M.J.Black, \emph{Fields of experts: A frame for learning image priors}.\hskip 1em plus
  0.5em minus 0.4em\relax in Proc. IEEE Conf. Computer Vision and Pattern Recognition, Jun.2005, vol.2,pp.860-867.

\bibitem{IEEEhowto:Atomic}
S.S.Chen, D.L.Donoho, and M.A.Saunders, \emph{Atomic decomposition by basisi pursuit}.\hskip 1em plus
  0.5em minus 0.4em\relax SIAM Rev., vol.43,no.1,pp.129-59,2001.

\bibitem{IEEEhowto:Stable}
D.L.Donoho,M.Elad, and V.Temlyakov, \emph{Stable recovery of sparse overcomplete representations in the presence of noise}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans. Inf. Theory,vol.52,no.1,pp.6-18,Jan.2006.

\bibitem{IEEEhowto:Just}
J.A.Tropp, \emph{Just relax: Convex programming methods for subset selection and sparse approximation}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans. Inf. Theory,vol.51,no.3,pp.1030-1051,Mar.2005.

\bibitem{IEEEhowto:AWMF}
P.Zhang,F.Li \emph{A new adaptive weighted mean filter for removing salt-and-pepper noise}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Signal processing letters.,vol.21,no.10,pp.1280-1283,Oct.2014.

\bibitem{IEEEhowto:translation}
R.Eslami and H.Radha, \emph{Translation-invariant contourlet transform and its application to image denoising}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans. Image Process., vol.15, no.11, pp.3362-3374, Nov.2006.

\bibitem{IEEEhowto:scale}
J.Portilla, V.Strela, M.J.Wainwright, and E.P.Simoncelli, \emph{Image denoising using scale mixtures of gaussians in the wavelet doma}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans. Image Process., vol.12, no.11, pp.1338-1351, Nov. 2003.

\bibitem{IEEEhowto:Weighted}
O.G.Guleryuz, \emph{Weighted overcomplete denoising}.\hskip 1em plus
  0.5em minus 0.4em\relax presented at the Asilomar Conf. Signals and Systems, Pacific Grove,CA,Nov.2003.

\bibitem{IEEEhowto:Nonlinear}
O.G.Guleryuz, \emph{Nonlinear approximation based image recovery using adaptive sparse reconstructions and iterated denoising: Part II---Adaptive algorithms}.\hskip 1em plus
  0.5em minus 0.4em\relax. IEEE Trans. Image Process., vol 15,no.3,pp.554-571,Mar.2005.

\bibitem{IEEEhowto:Improved}
B.Matalaon, M.Elad, and M.zibulevsky, \emph{Improved denoising of images using modeling of the redundant contourlet transform}.\hskip 1em plus
  0.5em minus 0.4em\relax. presented at the SPIE Conf. Wavelets, Jul. 2005.

\bibitem{IEEEhowto:KSVD}
M.Elad and M.Aharon, \emph{Image Denoising via sparse and redundant representations over learned dictionaries}.\hskip 1em plus
  0.5em minus 0.4em\relax. presented at the SPIE Conf. Wavelets, Jul. 2005.

\bibitem{IEEEhowto:ITMF}
Jiang X. \emph{Iterative truncated arithmetic mean filter and its properties}.\hskip 1em plus
  0.5em minus 0.4em\relax Image Processing, IEEE Transactions on, 2012, 21(4): 1537-1547.

\bibitem{IEEEhowto:realization}
Miao Z, Jiang X. \emph{Further properties and a fast realization of the iterative truncated arithmetic mean filter}.\hskip 1em plus
  0.5em minus 0.4em\relax Circuits and Systems II: Express Briefs, IEEE Transactions on, 2012, 59(11): 810-814.

\bibitem{IEEEhowto:WIMF}
 Miao Z, Jiang X. \emph{Weighted iterative truncated mean filter}.\hskip 1em plus
  0.5em minus 0.4em\relax Signal Processing, IEEE Transactions on, 2013, 61(16): 4149-4160.

\bibitem{IEEEhowto:additive}
Miao Z, Jiang X. \emph{Additive and exclusive noise suppression by iterative trimmed and truncated mean algorithm}.\hskip 1em plus
  0.5em minus 0.4em\relax Signal Processing, 2013.

\bibitem{IEEEhowto:technique}
D.L.Phillips \emph{A technique for the numerical solution of certain integral equations of the first kind}.\hskip 1em plus
  0.5em minus 0.4em\relax J.ACM 9(1962)84.

\bibitem{IEEEhowto:numerical}
L.Rudin, \emph{Images,numerical analysis of singularities and shock filters}.\hskip 1em plus
  0.5em minus 0.4em\relax Caltech, C.S. Dept. Report pp.5250-5287(1987)

\bibitem{IEEEhowto:DETECTION}
K.K.V.Toh,H.Ibrahim,and M.N.Mahyuddin, \emph{Salt-and-pepper noise detection and reduction using fuzzy switching median filter}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans. Consumer Electron.,vol.54,no.4,pp.1956-1961,Nov.2008.

\bibitem{IEEEhowto:detail-pres}
 W.Luo,\emph{An efficient detail-preserving approach for removing impulse noise in images}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Signal Process. Lett.,vol,13,no.7,pp.413-416,Jul.2006.

\bibitem{IEEEhowto:Adaptive impulse}
T.Chen and H.R.Wu, \emph{Adaptive impulse detection using center-weighted median filters}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Signal Process.Lett.,vol.8,no.1,pp.1-3,Jan.2001.

\bibitem{IEEEhowto:impulse noise}
X.Zhang and Y.Xiong \emph{Impulse noise removal using directional difference based noise detector and adaptive weighted mean filter}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Signal process.Lett.,vol.16,no.4,pp.295-298,Apr.2009.

\bibitem{IEEEhowto:Eficient}
W.Luo, \emph{Eficient removal of impulse noise from digital images}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans.Consumer Electron.,vol.52,no.2,pp.523-527,May 2006.

\bibitem{IEEEhowto:digital}
R.C.Gonzalez and R.E.Woods, \emph{Digital Image Processing,}.\hskip 1em plus
  0.5em minus 0.4em\relax 2nd ed. Upper Saddle River, NJ:Prentice-Hall,2002.

\bibitem{IEEEhowto:Fundamentals}
J.Astola and P.Kuosmanen \emph{Fundamentals of Nonlinear Digital Filtering}.\hskip 1em plus
  0.5em minus 0.4em\relax New York:CRC,1997.

\bibitem{IEEEhowto:nonlinear}
I.Pitas and A.N.Venetsanooulos \emph{Nonlinear Digital Filters:Principles and Applications}.\hskip 1em plus
  0.5em minus 0.4em\relax Boston,MA:Kluwer,1990.

\bibitem{IEEEhowto:noise adaptive soft}
H.L.Eng and K.K.Ma, \emph{Noise adapitve soft-switching median filter}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans.Image Processing,vol.10,pp.242-251,Feb,2001.

\bibitem{IEEEhowto:progressive switching}
Z.Wang and D.Zhang \emph{Progressive switching median filter for the removal of impulse noise from highly corrupted images}.\hskip 1em plus
  0.5em minus 0.4em\relax IEEE Trans.Circuits Syst.II,vol.46,pp.78-80,Jan.1999.

\bibitem{IEEEhowto:Gonzalez}
R.C.Gonzalez and R.E.Wodds, 阮秋琦(译)，\emph{数字图像处理（第二版）}[M] \hskip 1em plus
  0.5em minus 0.4em\relax  北京：电子工业出版社，2007.8.

\bibitem{pde}
G.Aubert, and P.Kornprobst \emph{Mathematical problems in image prcessing: partial differential equations and the calculus of variations 2nd ed. }[M]\hskip 1em plus
  0.5em minus 0.4em\relax 世界图书出版公司，2009.10.



\bibitem{IEEEhowto:imageprocessing}
M.Sonka, V.Hlavac and R.Boyle 艾海舟(译)，苏延超(译)，等(译) \emph{图像处理、分析与机器视觉}[M].\hskip 1em plus
  0.5em minus 0.4em\relax 北京：清华大学出版社，2011.1.

\bibitem{IEEEhowto:moshishibie}
边肇琪，张学工 \emph{模式识别}[M].\hskip 1em plus
  0.5em minus 0.4em\relax 清华大学出版社，2000.1.

\bibitem{IEEEhowto:imageSource}
Online.\hskip 1em plus
  0.5em minus 0.4em\relax http://www.math.cuhk.edu.hk/\~rchan/paper/impulse/results\_70.html.

\end{thebibliography}
\end{CJK*}

\begin{CJK*}{GBK}{kai}\newpage
\hspace*{\fill}\mbox{\Large\textbf{致\quad\,谢}}\hspace*{\fill}

\vspace*{5mm} 时光如白驹过隙，三年的硕士生活就要接近尾声了，回想起来，在华东师范大学读研期间的学习生活可谓充实而有意义。在这里，既提高了我的学术理论研究水平，又锻炼了自己的交际能力与教学能力，这些都将是我此生最宝贵的财富。

\vspace*{3mm} 硕士阶段的学习生活能够如此地充实而又精彩，首先，要感谢我的导师黎芳副教授， 她不仅品德高尚、为人宽厚、善解人意，而且知识渊博、追求卓越、严于律己，还在自己的研究方向上独树一帜，学术功底深厚，在学术研究上可谓兢兢业业、孜孜不倦。
在学术方面，她对学生要求很严格，很认真，在生活方面，她又很平易近人，关爱学生。三年来，老师那严谨的治学态度一直在影响着我。尤其是我跟着老师学习写论文的时候，老师非常热心地指导分析我的论文存在的问题，并不断地改进实验结果。老师对待学术问题的认真与一丝不苟，深深地影响着我，促使我不断地改进自己的论文，最终，文章得以成功发表。与老师相处的三年过程中，不仅学会了如何去做事，更明白了很多做人的道理。到今天我能顺利地完成学业，同样，跟老师的谆谆教诲密不可分。在文章写作的过程中，老师始终给予我细心的指导和帮助，在此，致以最诚挚的谢意！
%既是一位对学生的学术要求一丝不苟的严师,~ 又是一位在生活中关爱学生、诲人不倦的慈祥老师.
%~ 从踏入师门的那一刻,~ 老师就叮嘱我端正学习态度、明确学习目标.
%~ 三年来,~ 老师那渊博的知识和严谨治学的作风一直在潜移默化的影响着我,~ 尤其是跟随老师做助教工作期间,~ 更是领略了老师的教学魅力,~ 促使我不断完善自己的教学技能和教学水平.

%~ 从老师的身上,~ 我不仅学到了很多知识,~ 更领悟到了作为一名优秀的教师所应有的品行.~ 到今天我能顺利完成学业,~ 同样跟老师一直以来对我的谆谆教诲密不可分.
%~ 从论文的选题,~ 文章结构的建筑,~ 写作和修改,直到最后的定稿,~ 老师始终给予我细心的指导和耐心的帮助,~ 在此致以最诚挚的谢意!~

\vspace*{3mm} 同时衷心地感谢沈纯理，方发明，
毕平等老师在我学习期间给予我的学术熏陶和丰富的专业理论知识，
感谢辅导员赵纯奕老师和邹佳晨老师在日常生活中给予我无微不至的关怀和照顾，
他们兢兢业业，尽职尽责，无怨无悔地为我们排忧解难。

\vspace*{3mm} 还要感谢~2012~级数学系研究生班携手共走的各位同窗好友和同门师兄妹，
在这样一个大集体中，我感到的是充满快乐而不是枯燥的求学之路。
同学们认真严谨的学术态度和勤奋好学的高贵品质，深深地影响着我，并感化和鞭策着我顺利完成学业。


特别要感谢我的同门师姐陈晓宁在平时学习与生活中给予我的所有的帮助，

还有我的好朋友：~潘亚飞，~吴其明,~陈秀,~蔡海銮,~ 王静,~席段段等对我的关心、帮助和支持，
和她们相处的这三年，带给我无数快乐的学生时光，
她们的友谊是我一生最大的财富，值得我永远珍藏和回忆。

\vspace*{3mm} 最后还要感谢我的父母和家人，
是他们的支持与鼓励让我拥有了昂首学习的信心！

\vspace*{3mm} 谨以此文作为我三年学习生涯的总结，
并再次向曾经给予我鼓励和帮助的老师及同学表达我最衷心的感谢和祝福,
同时感谢答辩委员会的所有专家和学者，谢谢！

\end{CJK*}



\clearpage

\end{document}
